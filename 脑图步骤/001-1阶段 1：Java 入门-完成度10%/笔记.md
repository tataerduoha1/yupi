# é˜¶æ®µ 1ï¼šJava å…¥é—¨

å…¨æ–‡æ ‡å¿—ï¼š

ğŸš©è¿›è¡Œä¸­

ğŸå·²å®Œæˆ

ğŸ³ï¸â€ğŸŒˆæœªåš

ğŸ´ä¸çœ‹

â­æ¨è

## å‰æœŸå‡†å¤‡

- ğŸ æ¨èä½¿ç”¨ Markdown è¯­æ³•ç¼–å†™ï¼Œé±¼çš®æ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1no4y1k7YT/

  - å·¥å…·

    - https://editor.mdnice.com/
    - 

  - githubï¼šhttps://github.com/younghz/Markdown è¯­æ³•ã€æ•™ç¨‹
    - ä½¿ç”¨`#`ï¼Œå¯è¡¨ç¤º1-6çº§æ ‡é¢˜ã€‚

    > 1. åˆ—è¡¨
    >
    > 2. > åµŒå¥—
    >    >
    >    > ---
    >    >
>    > åˆ†å‰²çº¿
    >    >
    >    > ----
    >    >
    >    > *æ–œä½“*
    >    >
    >    > # æ ‡é¢˜1
    >    >
    >    > ## æ ‡é¢˜2
    >    >
    >    > :ambulance:
    >    >
    >    > :banana:
    >    >
    >    > 




## JAVAç¼–ç¨‹åŸºç¡€ï¼ˆ45å¤©ï¼‰

### æ•°ç»„

```java
import java.util.Arrays;

public class Test {
    public static void main(String[] args) {
        //å£°æ˜ä¸€ç»´æ•°ç»„ï¼ˆæ•°ç»„ä¸­çš„æ•°å€¼å‹å…ƒç´ ï¼ˆåŒ…æ‹¬byteã€charã€intã€shortã€floatã€doubleã€longï¼‰çš„é»˜è®¤å€¼éƒ½æ˜¯0ã€‚å¸ƒå°”å‹çš„é»˜è®¤å€¼æ˜¯falseï¼‰,äºŒç»´æ•°ç»„åŒç†
        int[] ints = new int[5];
        int[] ints2 = {1, 2, 4, 3, 6};
        String str[] = {"1", "aa", "c"};
        String str2[] = new String[]{"1", "aa", "c"};
        //å•ä¸ªèµ‹å€¼
        str[0] = "11";

        //æ•°ç»„å·¥å…·ç±»Arrays(æä¾›äº† æ’åºã€æŸ¥è¯¢ç­‰æ“ä½œ)
        Arrays.asList(new int[]{1, 5, 7, 0, 17});
        Arrays.sort(ints2);
        for (int i = 0; i < ints2.length; i++) {
            System.out.print(ints2[i] + " ");
        }
        System.out.println();
        System.out.println("3çš„ä½ç½®æ˜¯:" + Arrays.binarySearch(ints2, 3));
    }
}
```

#### æ•°ç»„å†…å­˜ï¼š

![æ•°ç»„å†…å­˜](/img/æ•°ç»„å†…å­˜.png)



### é¢å‘å¯¹è±¡

#### é‡è½½

```java
/**
 * é‡è½½(overloading) æ˜¯åœ¨ä¸€ä¸ªç±»é‡Œé¢ï¼Œæ–¹æ³•åå­—ç›¸åŒï¼Œè€Œå‚æ•°ä¸åŒã€‚è¿”å›ç±»å‹å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒã€‚
 * æ¯ä¸ªé‡è½½çš„æ–¹æ³•ï¼ˆæˆ–è€…æ„é€ å‡½æ•°ï¼‰éƒ½å¿…é¡»æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚
 * æœ€å¸¸ç”¨çš„åœ°æ–¹å°±æ˜¯æ„é€ å™¨çš„é‡è½½ã€‚
 *
 * é‡è½½è§„åˆ™:
 * è¢«é‡è½½çš„æ–¹æ³•å¿…é¡»æ”¹å˜å‚æ•°åˆ—è¡¨(å‚æ•°ä¸ªæ•°æˆ–ç±»å‹ä¸ä¸€æ ·)ï¼›
 * è¢«é‡è½½çš„æ–¹æ³•å¯ä»¥æ”¹å˜è¿”å›ç±»å‹ï¼›
 * è¢«é‡è½½çš„æ–¹æ³•å¯ä»¥æ”¹å˜è®¿é—®ä¿®é¥°ç¬¦ï¼›
 * è¢«é‡è½½çš„æ–¹æ³•å¯ä»¥å£°æ˜æ–°çš„æˆ–æ›´å¹¿çš„æ£€æŸ¥å¼‚å¸¸ï¼›
 * æ–¹æ³•èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­æˆ–è€…åœ¨ä¸€ä¸ªå­ç±»ä¸­è¢«é‡è½½ã€‚
 * æ— æ³•ä»¥è¿”å›å€¼ç±»å‹ä½œä¸ºé‡è½½å‡½æ•°çš„åŒºåˆ†æ ‡å‡†ã€‚
 */
public class Test {

    public String printStr(String str) {
        return str;
    }

    public int printStr(int a) {
        return a;
    }
}
```

#### å°è£…

```java
/**
 * åœ¨é¢å‘å¯¹è±¡ç¨‹å¼è®¾è®¡æ–¹æ³•ä¸­ï¼Œå°è£…ï¼ˆè‹±è¯­ï¼šEncapsulationï¼‰æ˜¯æŒ‡ä¸€ç§å°†æŠ½è±¡æ€§å‡½å¼æ¥å£çš„å®ç°ç»†èŠ‚éƒ¨åˆ†åŒ…è£…ã€éšè—èµ·æ¥çš„æ–¹æ³•ã€‚
 *
 * å°è£…å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¿æŠ¤å±éšœï¼Œé˜²æ­¢è¯¥ç±»çš„ä»£ç å’Œæ•°æ®è¢«å¤–éƒ¨ç±»å®šä¹‰çš„ä»£ç éšæœºè®¿é—®ã€‚
 * è¦è®¿é—®è¯¥ç±»çš„ä»£ç å’Œæ•°æ®ï¼Œå¿…é¡»é€šè¿‡ä¸¥æ ¼çš„æ¥å£æ§åˆ¶ã€‚
 * å°è£…æœ€ä¸»è¦çš„åŠŸèƒ½åœ¨äºæˆ‘ä»¬èƒ½ä¿®æ”¹è‡ªå·±çš„å®ç°ä»£ç ï¼Œè€Œä¸ç”¨ä¿®æ”¹é‚£äº›è°ƒç”¨æˆ‘ä»¬ä»£ç çš„ç¨‹åºç‰‡æ®µã€‚
 * é€‚å½“çš„å°è£…å¯ä»¥è®©ç¨‹å¼ç æ›´å®¹æ˜“ç†è§£ä¸ç»´æŠ¤ï¼Œä¹ŸåŠ å¼ºäº†ç¨‹å¼ç çš„å®‰å…¨æ€§ã€‚
 *
 * å°è£…çš„ä¼˜ç‚¹
 * 1. è‰¯å¥½çš„å°è£…èƒ½å¤Ÿå‡å°‘è€¦åˆã€‚
 * 2. ç±»å†…éƒ¨çš„ç»“æ„å¯ä»¥è‡ªç”±ä¿®æ”¹ã€‚
 * 3. å¯ä»¥å¯¹æˆå‘˜å˜é‡è¿›è¡Œæ›´ç²¾ç¡®çš„æ§åˆ¶ã€‚
 * 4. éšè—ä¿¡æ¯ï¼Œå®ç°ç»†èŠ‚ã€‚
 */
public class Test {
    
    private String fieldOne = "1";

    // å­—æ®µå’Œè½¬æ¢çš„é€»è¾‘å°è£…ï¼Œåªç•™ä¸€ä¸ªpublicæ–¹æ³•ç»™å¤–ç•Œã€‚åç»­æˆ‘å¯ä»¥ä¿®æ”¹é€»è¾‘ï¼Œè€Œå…¶ä»–åœ°æ–¹ä¸éœ€è¦æ”¹
    private int convertStr2Int(){
        return Integer.parseInt(fieldOne);
    }
    
    public int getFieldOne(){
        return convertStr2Int();
    }
}
```

#### å¤šæ€

```java
/**
 * å¤šæ€æ˜¯åŒä¸€ä¸ªè¡Œä¸ºå…·æœ‰å¤šä¸ªä¸åŒè¡¨ç°å½¢å¼æˆ–å½¢æ€çš„èƒ½åŠ›ã€‚
 *
 * å¤šæ€å°±æ˜¯åŒä¸€ä¸ªæ¥å£ï¼Œä½¿ç”¨ä¸åŒçš„å®ä¾‹è€Œæ‰§è¡Œä¸åŒæ“ä½œ
 * 
 * å¤šæ€çš„ä¼˜ç‚¹
 * 1. æ¶ˆé™¤ç±»å‹ä¹‹é—´çš„è€¦åˆå…³ç³»
 * 2. å¯æ›¿æ¢æ€§
 * 3. å¯æ‰©å……æ€§
 * 4. æ¥å£æ€§
 * 5. çµæ´»æ€§
 * 6. ç®€åŒ–æ€§
 * 
 * å¤šæ€å­˜åœ¨çš„ä¸‰ä¸ªå¿…è¦æ¡ä»¶:
 * ç»§æ‰¿
 * é‡å†™
 * çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ï¼šParent p = new Child();
 */
public class Test{
    void draw(){};
}

class TestChild1 extends Test{
    @Override
    void draw(){
        System.out.println("I am child 1");
    }
}

class TestChild2 extends Test{
    @Override
    void draw(){
        System.out.println("I am child 2");
    }
}
```

### æšä¸¾

```java
public class Test{
    public static void main(String[] args) {
        System.out.println(People.BLACK.getAgeByPeopleType());
    }
}

enum People{
    WHITE("è‹±å›½", "32å²", "173cm"),
    BLACK("å¤å·´", "2å²", "183cm"),
    YELLOW("æ—¥æœ¬", "18å²", "190cm");

    String nation;
    String age;
    String height;
    
    People(String nation, String age, String height){
        this.nation = nation;
        this.age = age;
        this.height = height;
    }

    public String getAgeByPeopleType() {
        return age;
    }
}
```

### å¸¸ç”¨ç±»

#### Stringç±»

*å­—ç¬¦ä¸²å¹¿æ³›åº”ç”¨ åœ¨ Java ç¼–ç¨‹ä¸­ï¼Œåœ¨ Java ä¸­å­—ç¬¦ä¸²å±äºå¯¹è±¡ï¼ŒJava æä¾›äº† String ç±»æ¥åˆ›å»ºå’Œæ“ä½œå­—ç¬¦ä¸²ã€‚String ç±»æœ‰ 11 ç§æ„é€ æ–¹æ³•*

**åˆ›å»ºå­—ç¬¦ä¸²**ï¼š

```java
String str = "Runoob";
String str2=new String("Runoob");

String s1 = "Runoob";              // String ç›´æ¥åˆ›å»º
String s2 = "Runoob";              // String ç›´æ¥åˆ›å»º
String s3 = s1;                    // ç›¸åŒå¼•ç”¨
String s4 = new String("Runoob");   // String å¯¹è±¡åˆ›å»º
String s5 = new String("Runoob");   // String å¯¹è±¡åˆ›å»º
```

![Stringä¸åŒåˆ›å»ºæ–¹å¼å†…å­˜](/img/Stringä¸åŒåˆ›å»ºæ–¹å¼å†…å­˜.png)

**æ³¨æ„:**

*String ç±»æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œæ‰€ä»¥ä½ ä¸€æ—¦åˆ›å»ºäº† String å¯¹è±¡ï¼Œé‚£å®ƒçš„å€¼å°±æ— æ³•æ”¹å˜äº†ã€‚ å¦‚æœéœ€è¦å¯¹å­—ç¬¦ä¸²åšå¾ˆå¤šä¿®æ”¹ï¼Œé‚£ä¹ˆåº”è¯¥é€‰æ‹©ä½¿ç”¨ StringBuffer & StringBuilder ç±»ã€‚*

String ç±»æ˜¯ä¸å¯æ”¹å˜çš„è§£æï¼Œä¾‹å¦‚ï¼š

```
String s = "Google";
System.out.println("s = " + s);

s = "Runoob";
System.out.println("s = " + s);
```

è¾“å‡ºç»“æœä¸ºï¼š

```
Google
Runoob
```

ä»ç»“æœä¸Šçœ‹æ˜¯æ”¹å˜äº†ï¼Œä½†ä¸ºä»€ä¹ˆé—¨è¯´Stringå¯¹è±¡æ˜¯ä¸å¯å˜çš„å‘¢ï¼Ÿ

*åŸå› åœ¨äºå®ä¾‹ä¸­çš„ **s** åªæ˜¯ä¸€ä¸ª **String** å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œå½“æ‰§è¡Œ **s = "Runoob";** åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ "Runoob"ï¼Œè€ŒåŸæ¥çš„ "Google" è¿˜å­˜åœ¨äºå†…å­˜ä¸­ã€‚*



#### æ—¥æœŸæ—¶é—´

> java.util åŒ…æä¾›äº† Date ç±»æ¥å°è£…å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚ Date ç±»æä¾›ä¸¤ä¸ªæ„é€ å‡½æ•°æ¥å®ä¾‹åŒ– Date å¯¹è±¡ã€‚
>
> ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°ä½¿ç”¨å½“å‰æ—¥æœŸå’Œæ—¶é—´æ¥åˆå§‹åŒ–å¯¹è±¡ã€‚
>
> Date( )
>
> ç¬¬äºŒä¸ªæ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä»1970å¹´1æœˆ1æ—¥èµ·çš„æ¯«ç§’æ•°ã€‚
>
> Date(long millisec)

```java
import java.text.SimpleDateFormat;
import java.util.Date;

public class Test {
    public static void main(String[] args) {
        // åˆå§‹åŒ– Date å¯¹è±¡
        Date date = new Date();

        // ä½¿ç”¨ toString() å‡½æ•°æ˜¾ç¤ºæ—¥æœŸæ—¶é—´
        System.out.println(date.toString());

        SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        System.out.println(simpleDateFormat.format(date));
    }
}

//è¾“å‡ºç»“æœï¼š
Sat Nov 13 19:41:40 CST 2021
2021-11-13 19:41:40
```

### é›†åˆç±»

> æ—©åœ¨ Java 2 ä¸­ä¹‹å‰ï¼ŒJava å°±æä¾›äº†ç‰¹è®¾ç±»ã€‚æ¯”å¦‚ï¼šDictionary, Vector, Stack, å’Œ Properties è¿™äº›ç±»ç”¨æ¥å­˜å‚¨å’Œæ“ä½œå¯¹è±¡ç»„ã€‚
>
> è™½ç„¶è¿™äº›ç±»éƒ½éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯å®ƒä»¬ç¼ºå°‘ä¸€ä¸ªæ ¸å¿ƒçš„ï¼Œç»Ÿä¸€çš„ä¸»é¢˜ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œä½¿ç”¨ Vector ç±»çš„æ–¹å¼å’Œä½¿ç”¨ Properties ç±»çš„æ–¹å¼æœ‰ç€å¾ˆå¤§ä¸åŒã€‚
>
> é›†åˆæ¡†æ¶è¢«è®¾è®¡æˆè¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªç›®æ ‡ã€‚
>
> - è¯¥æ¡†æ¶å¿…é¡»æ˜¯é«˜æ€§èƒ½çš„ã€‚åŸºæœ¬é›†åˆï¼ˆåŠ¨æ€æ•°ç»„ï¼Œé“¾è¡¨ï¼Œæ ‘ï¼Œå“ˆå¸Œè¡¨ï¼‰çš„å®ç°ä¹Ÿå¿…é¡»æ˜¯é«˜æ•ˆçš„ã€‚
> - è¯¥æ¡†æ¶å…è®¸ä¸åŒç±»å‹çš„é›†åˆï¼Œä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œï¼Œå…·æœ‰é«˜åº¦çš„äº’æ“ä½œæ€§ã€‚
> - å¯¹ä¸€ä¸ªé›†åˆçš„æ‰©å±•å’Œé€‚åº”å¿…é¡»æ˜¯ç®€å•çš„ã€‚
>
> ä¸ºæ­¤ï¼Œæ•´ä¸ªé›†åˆæ¡†æ¶å°±å›´ç»•ä¸€ç»„æ ‡å‡†æ¥å£è€Œè®¾è®¡ã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›æ¥å£çš„æ ‡å‡†å®ç°ï¼Œè¯¸å¦‚ï¼š **LinkedList**, **HashSet**, å’Œ **TreeSet** ç­‰,é™¤æ­¤ä¹‹å¤–ä½ ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›æ¥å£å®ç°è‡ªå·±çš„é›†åˆã€‚
>
> 
>
> ![JAVAé›†åˆæ¡†æ¶å›¾](/img/JAVAé›†åˆæ¡†æ¶å›¾.gif)
>
> ä»ä¸Šé¢çš„é›†åˆæ¡†æ¶å›¾å¯ä»¥çœ‹åˆ°ï¼ŒJava é›†åˆæ¡†æ¶ä¸»è¦åŒ…æ‹¬ä¸¤ç§ç±»å‹çš„å®¹å™¨ï¼Œä¸€ç§æ˜¯é›†åˆï¼ˆCollectionï¼‰ï¼Œå­˜å‚¨ä¸€ä¸ªå…ƒç´ é›†åˆï¼Œå¦ä¸€ç§æ˜¯å›¾ï¼ˆMapï¼‰ï¼Œå­˜å‚¨é”®/å€¼å¯¹æ˜ å°„ã€‚Collection æ¥å£åˆæœ‰ 3 ç§å­ç±»å‹ï¼ŒListã€Set å’Œ Queueï¼Œå†ä¸‹é¢æ˜¯ä¸€äº›æŠ½è±¡ç±»ï¼Œæœ€åæ˜¯å…·ä½“å®ç°ç±»ï¼Œå¸¸ç”¨çš„æœ‰ [ArrayList](https://www.runoob.com/java/java-arraylist.html)ã€[LinkedList](https://www.runoob.com/java/java-linkedlist.html)ã€[HashSet](https://www.runoob.com/java/java-hashset.html)ã€LinkedHashSetã€[HashMap](https://www.runoob.com/java/java-hashmap.html)ã€LinkedHashMap ç­‰ç­‰.
>
> 
>
> **é›†åˆæ¡†æ¶ä½“ç³»å¦‚å›¾æ‰€ç¤º**:
>
> ![é›†åˆæ¡†æ¶ä½“ç³»](/img/é›†åˆæ¡†æ¶ä½“ç³».png)
>
> 

### æ³›å‹

æ³›å‹æœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼Œåˆ†åˆ«ä¸ºï¼šæ³›å‹ç±»ã€æ³›å‹æ¥å£ã€æ³›å‹æ–¹æ³•ã€‚

#### æ³›å‹ç±»

```java
class ç±»åç§° <æ³›å‹æ ‡è¯†ï¼šå¯ä»¥éšä¾¿å†™ä»»æ„æ ‡è¯†å·ï¼Œæ ‡è¯†æŒ‡å®šçš„æ³›å‹çš„ç±»å‹>{
  private æ³›å‹æ ‡è¯† /*ï¼ˆæˆå‘˜å˜é‡ç±»å‹ï¼‰*/ var; 
	 .....
  }
}

//æ­¤å¤„Tå¯ä»¥éšä¾¿å†™ä¸ºä»»æ„æ ‡è¯†ï¼Œå¸¸è§çš„å¦‚Tã€Eã€Kã€Vç­‰å½¢å¼çš„å‚æ•°å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹
//åœ¨å®ä¾‹åŒ–æ³›å‹ç±»æ—¶ï¼Œå¿…é¡»æŒ‡å®šTçš„å…·ä½“ç±»å‹
public class Generic<T>{ 
    //keyè¿™ä¸ªæˆå‘˜å˜é‡çš„ç±»å‹ä¸ºT,Tçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š  
    private T key;

    public Generic(T key) { //æ³›å‹æ„é€ æ–¹æ³•å½¢å‚keyçš„ç±»å‹ä¹Ÿä¸ºTï¼ŒTçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š
        this.key = key;
    }

    public T getKey(){ //æ³›å‹æ–¹æ³•getKeyçš„è¿”å›å€¼ç±»å‹ä¸ºTï¼ŒTçš„ç±»å‹ç”±å¤–éƒ¨æŒ‡å®š
        return key;
    }
}
```



#### æ³›å‹æ¥å£

æ³›å‹æ¥å£ä¸æ³›å‹ç±»çš„å®šä¹‰åŠä½¿ç”¨åŸºæœ¬ç›¸åŒã€‚æ³›å‹æ¥å£å¸¸è¢«ç”¨åœ¨å„ç§ç±»çš„ç”Ÿäº§å™¨ä¸­.

```java
//å®šä¹‰ä¸€ä¸ªæ³›å‹æ¥å£
public interface Generator<T> {
    public T next();
}


/**
 * æœªä¼ å…¥æ³›å‹å®å‚æ—¶ï¼Œä¸æ³›å‹ç±»çš„å®šä¹‰ç›¸åŒï¼Œåœ¨å£°æ˜ç±»çš„æ—¶å€™ï¼Œéœ€å°†æ³›å‹çš„å£°æ˜ä¹Ÿä¸€èµ·åŠ åˆ°ç±»ä¸­
 * å³ï¼šclass FruitGenerator<T> implements Generator<T>{
 * å¦‚æœä¸å£°æ˜æ³›å‹ï¼Œå¦‚ï¼šclass FruitGenerator implements Generator<T>ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š"Unknown class"
 */
class FruitGenerator<T> implements Generator<T>{
    @Override
    public T next() {
        return null;
    }
}


/**
 * ä¼ å…¥æ³›å‹å®å‚æ—¶ï¼š
 * å®šä¹‰ä¸€ä¸ªç”Ÿäº§å™¨å®ç°è¿™ä¸ªæ¥å£,è™½ç„¶æˆ‘ä»¬åªåˆ›å»ºäº†ä¸€ä¸ªæ³›å‹æ¥å£Generator<T>
 * ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¸ºTä¼ å…¥æ— æ•°ä¸ªå®å‚ï¼Œå½¢æˆæ— æ•°ç§ç±»å‹çš„Generatoræ¥å£ã€‚
 * åœ¨å®ç°ç±»å®ç°æ³›å‹æ¥å£æ—¶ï¼Œå¦‚å·²å°†æ³›å‹ç±»å‹ä¼ å…¥å®å‚ç±»å‹ï¼Œåˆ™æ‰€æœ‰ä½¿ç”¨æ³›å‹çš„åœ°æ–¹éƒ½è¦æ›¿æ¢æˆä¼ å…¥çš„å®å‚ç±»å‹
 * å³ï¼šGenerator<T>ï¼Œpublic T next();ä¸­çš„çš„Téƒ½è¦æ›¿æ¢æˆä¼ å…¥çš„Stringç±»å‹ã€‚
 */
public class FruitGenerator implements Generator<String> {

    private String[] fruits = new String[]{"Apple", "Banana", "Pear"};

    @Override
    public String next() {
        Random rand = new Random();
        return fruits[rand.nextInt(3)];
    }
}


æˆ‘ä»¬çŸ¥é“Ingeteræ˜¯Numberçš„ä¸€ä¸ªå­ç±»ï¼ŒåŒæ—¶åœ¨ç‰¹æ€§ç« èŠ‚ä¸­æˆ‘ä»¬ä¹ŸéªŒè¯è¿‡Generic<Ingeter>ä¸Generic<Number>å®é™…ä¸Šæ˜¯ç›¸åŒçš„ä¸€ç§åŸºæœ¬ç±»å‹ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåœ¨ä½¿ç”¨Generic<Number>ä½œä¸ºå½¢å‚çš„æ–¹æ³•ä¸­ï¼Œèƒ½å¦ä½¿ç”¨Generic<Ingeter>çš„å®ä¾‹ä¼ å…¥å‘¢ï¼Ÿåœ¨é€»è¾‘ä¸Šç±»ä¼¼äºGeneric<Number>å’ŒGeneric<Ingeter>æ˜¯å¦å¯ä»¥çœ‹æˆå…·æœ‰çˆ¶å­å…³ç³»çš„æ³›å‹ç±»å‹å‘¢ï¼Ÿ
//Generic<Integer>ä¸èƒ½è¢«çœ‹ä½œä¸º`Generic<Number>çš„å­ç±»ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡º:åŒä¸€ç§æ³›å‹å¯ä»¥å¯¹åº”å¤šä¸ªç‰ˆæœ¬ï¼ˆå› ä¸ºå‚æ•°ç±»å‹æ˜¯ä¸ç¡®å®šçš„ï¼‰ï¼Œä¸åŒç‰ˆæœ¬çš„æ³›å‹ç±»å®ä¾‹æ˜¯ä¸å…¼å®¹çš„ã€‚
//å›åˆ°ä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚ä½•è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Ÿæ€»ä¸èƒ½ä¸ºäº†å®šä¹‰ä¸€ä¸ªæ–°çš„æ–¹æ³•æ¥å¤„ç†Generic<Integer>ç±»å‹çš„ç±»ï¼Œè¿™æ˜¾ç„¶ä¸javaä¸­çš„å¤šå°ç†å¿µç›¸è¿èƒŒã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ¨é€»è¾‘ä¸Šå¯ä»¥è¡¨ç¤ºåŒæ—¶æ˜¯Generic<Integer>å’ŒGeneric<Number>çˆ¶ç±»çš„å¼•ç”¨ç±»å‹ã€‚ç”±æ­¤ç±»å‹é€šé…ç¬¦åº”è¿è€Œç”Ÿã€‚
//æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„æ–¹æ³•æ”¹ä¸€ä¸‹ï¼š
public void showKeyValue1(Generic<?> obj){
    Log.d("æ³›å‹æµ‹è¯•","key value is " + obj.getKey());
}
//ç±»å‹é€šé…ç¬¦ä¸€èˆ¬æ˜¯ä½¿ç”¨ï¼Ÿä»£æ›¿å…·ä½“çš„ç±»å‹å®å‚ï¼Œæ³¨æ„äº†ï¼Œæ­¤å¤„â€™ï¼Ÿâ€™æ˜¯ç±»å‹å®å‚ï¼Œè€Œä¸æ˜¯ç±»å‹å½¢å‚ ã€‚é‡è¦è¯´ä¸‰éï¼æ­¤å¤„â€™ï¼Ÿâ€™æ˜¯ç±»å‹å®å‚ï¼Œè€Œä¸æ˜¯ç±»å‹å½¢å‚ ï¼ æ­¤å¤„â€™ï¼Ÿâ€™æ˜¯ç±»å‹å®å‚ï¼Œè€Œä¸æ˜¯ç±»å‹å½¢å‚ ï¼å†ç›´ç™½ç‚¹çš„æ„æ€å°±æ˜¯ï¼Œæ­¤å¤„çš„ï¼Ÿå’ŒNumberã€Stringã€Integerä¸€æ ·éƒ½æ˜¯ä¸€ç§å®é™…çš„ç±»å‹ï¼Œå¯ä»¥æŠŠï¼Ÿçœ‹æˆæ‰€æœ‰ç±»å‹çš„çˆ¶ç±»ã€‚æ˜¯ä¸€ç§çœŸå®çš„ç±»å‹ã€‚

//å¯ä»¥è§£å†³å½“å…·ä½“ç±»å‹ä¸ç¡®å®šçš„æ—¶å€™ï¼Œè¿™ä¸ªé€šé…ç¬¦å°±æ˜¯ ?  ï¼›å½“æ“ä½œç±»å‹æ—¶ï¼Œä¸éœ€è¦ä½¿ç”¨ç±»å‹çš„å…·ä½“åŠŸèƒ½æ—¶ï¼Œåªä½¿ç”¨Objectç±»ä¸­çš„åŠŸèƒ½ã€‚é‚£ä¹ˆå¯ä»¥ç”¨ ? é€šé…ç¬¦æ¥è¡¨æœªçŸ¥ç±»å‹ã€‚
```



#### æ³›å‹æ–¹æ³•

```java
/**
 * æ³›å‹æ–¹æ³•çš„åŸºæœ¬ä»‹ç»
 * @param tClass ä¼ å…¥çš„æ³›å‹å®å‚
 * @return T è¿”å›å€¼ä¸ºTç±»å‹
 * è¯´æ˜ï¼š
 *     1ï¼‰public ä¸ è¿”å›å€¼ä¸­é—´<T>éå¸¸é‡è¦ï¼Œå¯ä»¥ç†è§£ä¸ºå£°æ˜æ­¤æ–¹æ³•ä¸ºæ³›å‹æ–¹æ³•ã€‚
 *     2ï¼‰åªæœ‰å£°æ˜äº†<T>çš„æ–¹æ³•æ‰æ˜¯æ³›å‹æ–¹æ³•ï¼Œæ³›å‹ç±»ä¸­çš„ä½¿ç”¨äº†æ³›å‹çš„æˆå‘˜æ–¹æ³•å¹¶ä¸æ˜¯æ³›å‹æ–¹æ³•ã€‚
 *     3ï¼‰<T>è¡¨æ˜è¯¥æ–¹æ³•å°†ä½¿ç”¨æ³›å‹ç±»å‹Tï¼Œæ­¤æ—¶æ‰å¯ä»¥åœ¨æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹ç±»å‹Tã€‚
 *     4ï¼‰ä¸æ³›å‹ç±»çš„å®šä¹‰ä¸€æ ·ï¼Œæ­¤å¤„Tå¯ä»¥éšä¾¿å†™ä¸ºä»»æ„æ ‡è¯†ï¼Œå¸¸è§çš„å¦‚Tã€Eã€Kã€Vç­‰å½¢å¼çš„å‚æ•°å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹ã€‚
 */
public <T> T genericMethod(Class<T> tClass)throws InstantiationException ,
  IllegalAccessException{
        T instance = tClass.newInstance();
        return instance;
}
```

```java
public class GenericTest {
    //è¿™ä¸ªç±»æ˜¯ä¸ªæ³›å‹ç±»ï¼Œåœ¨ä¸Šé¢å·²ç»ä»‹ç»è¿‡
    public class Generic<T>{
        private T key;

        public Generic(T key) {
            this.key = key;
        }

        //æˆ‘æƒ³è¯´çš„å…¶å®æ˜¯è¿™ä¸ªï¼Œè™½ç„¶åœ¨æ–¹æ³•ä¸­ä½¿ç”¨äº†æ³›å‹ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ã€‚
        //è¿™åªæ˜¯ç±»ä¸­ä¸€ä¸ªæ™®é€šçš„æˆå‘˜æ–¹æ³•ï¼Œåªä¸è¿‡ä»–çš„è¿”å›å€¼æ˜¯åœ¨å£°æ˜æ³›å‹ç±»å·²ç»å£°æ˜è¿‡çš„æ³›å‹ã€‚
        //æ‰€ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ‰å¯ä»¥ç»§ç»­ä½¿ç”¨ T è¿™ä¸ªæ³›å‹ã€‚
        public T getKey(){
            return key;
        }

        /**
         * è¿™ä¸ªæ–¹æ³•æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ï¼Œåœ¨ç¼–è¯‘å™¨ä¼šç»™æˆ‘ä»¬æç¤ºè¿™æ ·çš„é”™è¯¯ä¿¡æ¯"cannot reslove symbol E"
         * å› ä¸ºåœ¨ç±»çš„å£°æ˜ä¸­å¹¶æœªå£°æ˜æ³›å‹Eï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨Eåšå½¢å‚å’Œè¿”å›å€¼ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ— æ³•è¯†åˆ«ã€‚
         public E setKey(E key){
         this.key = keu
         }
         */
    }

    /**
     * è¿™æ‰æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ³›å‹æ–¹æ³•ã€‚
     * é¦–å…ˆåœ¨publicä¸è¿”å›å€¼ä¹‹é—´çš„<T>å¿…ä¸å¯å°‘ï¼Œè¿™è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œå¹¶ä¸”å£°æ˜äº†ä¸€ä¸ªæ³›å‹T
     * è¿™ä¸ªTå¯ä»¥å‡ºç°åœ¨è¿™ä¸ªæ³›å‹æ–¹æ³•çš„ä»»æ„ä½ç½®.
     * æ³›å‹çš„æ•°é‡ä¹Ÿå¯ä»¥ä¸ºä»»æ„å¤šä¸ª
     *    å¦‚ï¼špublic <T,K> K showKeyName(Generic<T> container){
     *        ...
     *        }
     */
    public <T> T showKeyName(Generic<T> container){
        System.out.println("container key :" + container.getKey());
        //å½“ç„¶è¿™ä¸ªä¾‹å­ä¸¾çš„ä¸å¤ªåˆé€‚ï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜æ³›å‹æ–¹æ³•çš„ç‰¹æ€§ã€‚
        T test = container.getKey();
        return test;
    }

    //è¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ï¼Œåªæ˜¯ä½¿ç”¨äº†Generic<Number>è¿™ä¸ªæ³›å‹ç±»åšå½¢å‚è€Œå·²ã€‚
    public void showKeyValue1(Generic<Number> obj){
        System.out.println("æ³›å‹æµ‹è¯• key value is " + obj.getKey());;
    }

    //è¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šçš„æ–¹æ³•ï¼Œåªä¸è¿‡ä½¿ç”¨äº†æ³›å‹é€šé…ç¬¦?
    //åŒæ—¶è¿™ä¹Ÿå°è¯äº†æ³›å‹é€šé…ç¬¦ç« èŠ‚æ‰€æè¿°çš„ï¼Œ?æ˜¯ä¸€ç§ç±»å‹å®å‚ï¼Œå¯ä»¥çœ‹åšä¸ºNumberç­‰æ‰€æœ‰ç±»çš„çˆ¶ç±»
    public void showKeyValue2(Generic<?> obj){
        System.out.println("æ³›å‹æµ‹è¯•key value is " + obj.getKey());
    }

    /**
     * è¿™ä¸ªæ–¹æ³•æ˜¯æœ‰é—®é¢˜çš„ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬æç¤ºé”™è¯¯ä¿¡æ¯ï¼š"UnKnown class 'E' "
     * è™½ç„¶æˆ‘ä»¬å£°æ˜äº†<T>,ä¹Ÿè¡¨æ˜äº†è¿™æ˜¯ä¸€ä¸ªå¯ä»¥å¤„ç†æ³›å‹çš„ç±»å‹çš„æ³›å‹æ–¹æ³•ã€‚
     * ä½†æ˜¯åªå£°æ˜äº†æ³›å‹ç±»å‹Tï¼Œå¹¶æœªå£°æ˜æ³›å‹ç±»å‹Eï¼Œå› æ­¤ç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“è¯¥å¦‚ä½•å¤„ç†Eè¿™ä¸ªç±»å‹ã€‚
     public <T> T showKeyName(Generic<E> container){
     ...
     }
     */

    /**
     * è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬æç¤ºé”™è¯¯ä¿¡æ¯ï¼š"UnKnown class 'T' "
     * å¯¹äºç¼–è¯‘å™¨æ¥è¯´Tè¿™ä¸ªç±»å‹å¹¶æœªé¡¹ç›®ä¸­å£°æ˜è¿‡ï¼Œå› æ­¤ç¼–è¯‘ä¹Ÿä¸çŸ¥é“è¯¥å¦‚ä½•ç¼–è¯‘è¿™ä¸ªç±»ã€‚
     * æ‰€ä»¥è¿™ä¹Ÿä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„æ³›å‹æ–¹æ³•å£°æ˜ã€‚
     public void showkey(T genericObj){

     }
     */

    public static void main(String[] args) {


    }
}
```

```java
public class GenericFruit {
    class Fruit{
        @Override
        public String toString() {
            return "fruit";
        }
    }

    class Apple extends Fruit{
        @Override
        public String toString() {
            return "apple";
        }
    }

    class Person{
        @Override
        public String toString() {
            return "Person";
        }
    }

    class GenerateTest<T>{
        public void show_1(T t){
            System.out.println(t.toString());
        }

        //åœ¨æ³›å‹ç±»ä¸­å£°æ˜äº†ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œä½¿ç”¨æ³›å‹Eï¼Œè¿™ç§æ³›å‹Eå¯ä»¥ä¸ºä»»æ„ç±»å‹ã€‚å¯ä»¥ç±»å‹ä¸Tç›¸åŒï¼Œä¹Ÿå¯ä»¥ä¸åŒã€‚
        //ç”±äºæ³›å‹æ–¹æ³•åœ¨å£°æ˜çš„æ—¶å€™ä¼šå£°æ˜æ³›å‹<E>ï¼Œå› æ­¤å³ä½¿åœ¨æ³›å‹ç±»ä¸­å¹¶æœªå£°æ˜æ³›å‹ï¼Œç¼–è¯‘å™¨ä¹Ÿèƒ½å¤Ÿæ­£ç¡®è¯†åˆ«æ³›å‹æ–¹æ³•ä¸­è¯†åˆ«çš„æ³›å‹ã€‚
        public <E> void show_3(E t){
            System.out.println(t.toString());
        }

        //åœ¨æ³›å‹ç±»ä¸­å£°æ˜äº†ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œä½¿ç”¨æ³›å‹Tï¼Œæ³¨æ„è¿™ä¸ªTæ˜¯ä¸€ç§å…¨æ–°çš„ç±»å‹ï¼Œå¯ä»¥ä¸æ³›å‹ç±»ä¸­å£°æ˜çš„Tä¸æ˜¯åŒä¸€ç§ç±»å‹ã€‚
        public <T> void show_2(T t){
            System.out.println(t.toString());
        }
    }

    public static void main(String[] args) {
        Apple apple = new Apple();
        Person person = new Person();

        GenerateTest<Fruit> generateTest = new GenerateTest<Fruit>();
        //appleæ˜¯Fruitçš„å­ç±»ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥
        generateTest.show_1(apple);
        //ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ³›å‹ç±»å‹å®å‚æŒ‡å®šçš„æ˜¯Fruitï¼Œè€Œä¼ å…¥çš„å®å‚ç±»æ˜¯Person
        //generateTest.show_1(person);

        //ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æˆåŠŸ
        generateTest.show_2(apple);
        generateTest.show_2(person);

        //ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¹Ÿéƒ½å¯ä»¥æˆåŠŸ
        generateTest.show_3(apple);
        generateTest.show_3(person);
    }
}
```

##### æ³›å‹æ–¹æ³•ä¸å¯å˜å‚æ•°

```java
public class GenericFruit {
    public <T> void printMsg( T... args){
        for(T t : args){
            Log.d("æ³›å‹æµ‹è¯•","t is " + t);
        }
    }
}
```

##### é™æ€æ–¹æ³•ä¸æ³›å‹

```java
public class StaticGenerator<T> {
    /**
     * å¦‚æœåœ¨ç±»ä¸­å®šä¹‰ä½¿ç”¨æ³›å‹çš„é™æ€æ–¹æ³•ï¼Œéœ€è¦æ·»åŠ é¢å¤–çš„æ³›å‹å£°æ˜ï¼ˆå°†è¿™ä¸ªæ–¹æ³•å®šä¹‰æˆæ³›å‹æ–¹æ³•ï¼‰
     * å³ä½¿é™æ€æ–¹æ³•è¦ä½¿ç”¨æ³›å‹ç±»ä¸­å·²ç»å£°æ˜è¿‡çš„æ³›å‹ä¹Ÿä¸å¯ä»¥ã€‚
     * å¦‚ï¼špublic static void show(T t){..},æ­¤æ—¶ç¼–è¯‘å™¨ä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼š
     "StaticGenerator cannot be refrenced from static context"
     */
    public static <T> void show(T t){

    }
}
```

#### æ³›å‹ä¸Šä¸‹è¾¹ç•Œ

*åœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸ºä¼ å…¥çš„æ³›å‹ç±»å‹å®å‚è¿›è¡Œä¸Šä¸‹è¾¹ç•Œçš„é™åˆ¶ï¼Œå¦‚ï¼šç±»å‹å®å‚åªå‡†ä¼ å…¥æŸç§ç±»å‹çš„çˆ¶ç±»æˆ–æŸç§ç±»å‹çš„å­ç±»ã€‚ä¸ºæ³›å‹æ·»åŠ ä¸Šè¾¹ç•Œï¼Œå³ä¼ å…¥çš„ç±»å‹å®å‚å¿…é¡»æ˜¯æŒ‡å®šç±»å‹çš„å­ç±»å‹*

```java
public void showKeyValue1(Generic<? extends Number> obj){
    Log.d("æ³›å‹æµ‹è¯•","key value is " + obj.getKey());
}

//åœ¨æ³›å‹æ–¹æ³•ä¸­æ·»åŠ ä¸Šä¸‹è¾¹ç•Œé™åˆ¶çš„æ—¶å€™ï¼Œå¿…é¡»åœ¨æƒé™å£°æ˜ä¸è¿”å›å€¼ä¹‹é—´çš„<T>ä¸Šæ·»åŠ ä¸Šä¸‹è¾¹ç•Œï¼Œå³åœ¨æ³›å‹å£°æ˜çš„æ—¶å€™æ·»åŠ 
//public <T> T showKeyName(Generic<T extends Number> container)ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼š"Unexpected bound"
public <T extends Number> T showKeyName(Generic<T> container){
    System.out.println("container key :" + container.getKey());
    T test = container.getKey();
    return test;
}
```

#### æ³›å‹æ•°ç»„

çœ‹åˆ°äº†å¾ˆå¤šæ–‡ç« ä¸­éƒ½ä¼šæèµ·æ³›å‹æ•°ç»„ï¼Œç»è¿‡æŸ¥çœ‹sunçš„è¯´æ˜æ–‡æ¡£ï¼Œåœ¨javaä¸­æ˜¯â€ä¸èƒ½åˆ›å»ºä¸€ä¸ªç¡®åˆ‡çš„æ³›å‹ç±»å‹çš„æ•°ç»„â€çš„ã€‚

ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢çš„è¿™ä¸ªä¾‹å­æ˜¯ä¸å¯ä»¥çš„ï¼š

```
List<String>[] ls = new ArrayList<String>[10];  
```

è€Œä½¿ç”¨é€šé…ç¬¦åˆ›å»ºæ³›å‹æ•°ç»„æ˜¯å¯ä»¥çš„ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

```
List<?>[] ls = new ArrayList<?>[10]; 
```

è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š

```
List<String>[] ls = new ArrayList[10];
```

### **æ³¨è§£**

#### ***å†…ç½®çš„æ³¨è§£ï¼š***

Java å®šä¹‰äº†ä¸€å¥—æ³¨è§£ï¼Œå…±æœ‰ 7 ä¸ªï¼Œ3 ä¸ªåœ¨ java.lang ä¸­ï¼Œå‰©ä¸‹ 4 ä¸ªåœ¨java.lang.annotation ä¸­ã€‚

***ä½œç”¨åœ¨ä»£ç çš„æ³¨è§£æ˜¯ï¼š***

- @Override - æ£€æŸ¥è¯¥æ–¹æ³•æ˜¯å¦æ˜¯é‡å†™æ–¹æ³•ã€‚å¦‚æœå‘ç°å…¶çˆ¶ç±»ï¼Œæˆ–è€…æ˜¯å¼•ç”¨çš„æ¥å£ä¸­å¹¶æ²¡æœ‰è¯¥æ–¹æ³•æ—¶ï¼Œä¼šæŠ¥ç¼–è¯‘é”™è¯¯ã€‚
- @Deprecated - æ ‡è®°è¿‡æ—¶æ–¹æ³•ã€‚å¦‚æœä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä¼šæŠ¥ç¼–è¯‘è­¦å‘Šã€‚
- @SuppressWarnings - æŒ‡ç¤ºç¼–è¯‘å™¨å»å¿½ç•¥æ³¨è§£ä¸­å£°æ˜çš„è­¦å‘Šã€‚

***ä½œç”¨åœ¨å…¶ä»–æ³¨è§£çš„æ³¨è§£***(æˆ–è€…è¯´ å…ƒæ³¨è§£)æ˜¯:

- @Retention - æ ‡è¯†è¿™ä¸ªæ³¨è§£æ€ä¹ˆä¿å­˜ï¼Œæ˜¯åªåœ¨ä»£ç ä¸­ï¼Œè¿˜æ˜¯ç¼–å…¥classæ–‡ä»¶ä¸­ï¼Œæˆ–è€…æ˜¯åœ¨è¿è¡Œæ—¶å¯ä»¥é€šè¿‡åå°„è®¿é—®ã€‚
- @Documented - æ ‡è®°è¿™äº›æ³¨è§£æ˜¯å¦åŒ…å«åœ¨ç”¨æˆ·æ–‡æ¡£ä¸­ã€‚
- @Target - æ ‡è®°è¿™ä¸ªæ³¨è§£åº”è¯¥æ˜¯å“ªç§ Java æˆå‘˜ã€‚
- @Inherited - æ ‡è®°è¿™ä¸ªæ³¨è§£æ˜¯ç»§æ‰¿äºå“ªä¸ªæ³¨è§£ç±»(é»˜è®¤ æ³¨è§£å¹¶æ²¡æœ‰ç»§æ‰¿äºä»»ä½•å­ç±»)

ä» Java 7 å¼€å§‹ï¼Œé¢å¤–æ·»åŠ äº† 3 ä¸ªæ³¨è§£:

- @SafeVarargs - Java 7 å¼€å§‹æ”¯æŒï¼Œå¿½ç•¥ä»»ä½•ä½¿ç”¨å‚æ•°ä¸ºæ³›å‹å˜é‡çš„æ–¹æ³•æˆ–æ„é€ å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„è­¦å‘Šã€‚
- @FunctionalInterface - Java 8 å¼€å§‹æ”¯æŒï¼Œæ ‡è¯†ä¸€ä¸ªåŒ¿åå‡½æ•°æˆ–å‡½æ•°å¼æ¥å£ã€‚
- @Repeatable - Java 8 å¼€å§‹æ”¯æŒï¼Œæ ‡è¯†æŸæ³¨è§£å¯ä»¥åœ¨åŒä¸€ä¸ªå£°æ˜ä¸Šä½¿ç”¨å¤šæ¬¡ã€‚

#### ***æ³¨è§£æ¶æ„ï¼š***

![æ³¨è§£æ¶æ„](/img/æ³¨è§£æ¶æ„.jpg)

> ä»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š
>
> > **(01) 1 ä¸ª Annotation å’Œ 1 ä¸ª RetentionPolicy å…³è”ã€‚**
> >
> > å¯ä»¥ç†è§£ä¸ºï¼šæ¯1ä¸ªAnnotationå¯¹è±¡ï¼Œéƒ½ä¼šæœ‰å”¯ä¸€çš„RetentionPolicyå±æ€§ã€‚
> >
> > **(02) 1 ä¸ª Annotation å’Œ 1~n ä¸ª ElementType å…³è”ã€‚**
> >
> > å¯ä»¥ç†è§£ä¸ºï¼šå¯¹äºæ¯ 1 ä¸ª Annotation å¯¹è±¡ï¼Œå¯ä»¥æœ‰è‹¥å¹²ä¸ª ElementType å±æ€§ã€‚
> >
> > **(03) Annotation æœ‰è®¸å¤šå®ç°ç±»ï¼ŒåŒ…æ‹¬ï¼šDeprecated, Documented, Inherited, Override ç­‰ç­‰ã€‚**
> >
> > Annotation çš„æ¯ä¸€ä¸ªå®ç°ç±»ï¼Œéƒ½ "å’Œ 1 ä¸ª RetentionPolicy å…³è”" å¹¶ä¸” " å’Œ 1~n ä¸ª ElementType å…³è”"ã€‚

> java Annotation çš„ç»„æˆä¸­ï¼Œæœ‰ 3 ä¸ªéå¸¸é‡è¦çš„ä¸»å¹²ç±»ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ï¼š
>
> 
>
> ***Annotation.java***
>
> > **package** java.lang.annotation;
> > **public** **interface** Annotation {
> >
> >   **boolean** equals(Object obj);
> >
> >   **int** hashCode();
> >
> >   String toString();
> >
> >   Class<? **extends** Annotation> annotationType();
> > }
>
> 
>
> ***ElementType.java***
>
> > **package** java.lang.annotation;
> >
> > **public** **enum** ElementType {
> >   TYPE,        */\* ç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨é‡Šç±»å‹ï¼‰æˆ–æšä¸¾å£°æ˜  \*/*
> >
> >   FIELD,        */\* å­—æ®µå£°æ˜ï¼ˆåŒ…æ‹¬æšä¸¾å¸¸é‡ï¼‰  \*/*
> >
> >   METHOD,       */\* æ–¹æ³•å£°æ˜  \*/*
> >
> >   PARAMETER,      */\* å‚æ•°å£°æ˜  \*/*
> >
> >   CONSTRUCTOR,     */\* æ„é€ æ–¹æ³•å£°æ˜  \*/*
> >
> >   LOCAL_VARIABLE,   */\* å±€éƒ¨å˜é‡å£°æ˜  \*/*
> >
> >   ANNOTATION_TYPE,   */\* æ³¨é‡Šç±»å‹å£°æ˜  \*/*
> >
> >   **PACKAGE**       */\* åŒ…å£°æ˜  \*/*
> > }
>
> 
>
> ***RetentionPolicy.java***
>
> > **package** java.lang.annotation;
> > **public** **enum** RetentionPolicy {
> >   SOURCE,       */\* Annotationä¿¡æ¯ä»…å­˜åœ¨äºç¼–è¯‘å™¨å¤„ç†æœŸé—´ï¼Œç¼–è¯‘å™¨å¤„ç†å®Œä¹‹åå°±æ²¡æœ‰è¯¥Annotationä¿¡æ¯äº†  \*/*
> >
> >   **CLASS**,       */\* ç¼–è¯‘å™¨å°†Annotationå­˜å‚¨äºç±»å¯¹åº”çš„.classæ–‡ä»¶ä¸­ã€‚é»˜è®¤è¡Œä¸º  \*/*
> >
> >   RUNTIME       */\* ç¼–è¯‘å™¨å°†Annotationå­˜å‚¨äºclassæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å¯ç”±JVMè¯»å…¥ \*/*
> > }

#### æ³¨è§£å®šä¹‰

```java
@Documented
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface MyAnnotation1 {
}
```

> è¯´æ˜ï¼š
>
> ä¸Šé¢çš„ä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ª Annotationï¼Œå®ƒçš„åå­—æ˜¯ MyAnnotation1ã€‚å®šä¹‰äº† MyAnnotation1 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­é€šè¿‡ *@MyAnnotation1* æ¥ä½¿ç”¨å®ƒã€‚ å…¶å®ƒçš„ï¼Œ@Documented, @Target, @Retention, @interface éƒ½æ˜¯æ¥ä¿®é¥° MyAnnotation1 çš„ã€‚ä¸‹é¢åˆ†åˆ«è¯´è¯´å®ƒä»¬çš„å«ä¹‰ï¼š
>
> **(01) @interface**
>
> ä½¿ç”¨ @interface å®šä¹‰æ³¨è§£æ—¶ï¼Œæ„å‘³ç€å®ƒå®ç°äº† java.lang.annotation.Annotation æ¥å£ï¼Œå³è¯¥æ³¨è§£å°±æ˜¯ä¸€ä¸ªAnnotationã€‚
>
> å®šä¹‰ Annotation æ—¶ï¼Œ@interface æ˜¯å¿…é¡»çš„ã€‚
>
> æ³¨æ„ï¼šå®ƒå’Œæˆ‘ä»¬é€šå¸¸çš„ implemented å®ç°æ¥å£çš„æ–¹æ³•ä¸åŒã€‚Annotation æ¥å£çš„å®ç°ç»†èŠ‚éƒ½ç”±ç¼–è¯‘å™¨å®Œæˆã€‚é€šè¿‡ @interface å®šä¹‰æ³¨è§£åï¼Œè¯¥æ³¨è§£ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æ¥å£ã€‚
>
> **(02) @Documented**
>
> ç±»å’Œæ–¹æ³•çš„ Annotation åœ¨ç¼ºçœæƒ…å†µä¸‹æ˜¯ä¸å‡ºç°åœ¨ javadoc ä¸­çš„ã€‚å¦‚æœä½¿ç”¨ @Documented ä¿®é¥°è¯¥ Annotationï¼Œåˆ™è¡¨ç¤ºå®ƒå¯ä»¥å‡ºç°åœ¨ javadoc ä¸­ã€‚
>
> å®šä¹‰ Annotation æ—¶ï¼Œ@Documented å¯æœ‰å¯æ— ï¼›è‹¥æ²¡æœ‰å®šä¹‰ï¼Œåˆ™ Annotation ä¸ä¼šå‡ºç°åœ¨ javadoc ä¸­ã€‚
>
> **(03) @Target(ElementType.TYPE)**
>
> å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼ŒElementType æ˜¯ Annotation çš„ç±»å‹å±æ€§ã€‚è€Œ @Target çš„ä½œç”¨ï¼Œå°±æ˜¯æ¥æŒ‡å®š Annotation çš„ç±»å‹å±æ€§ã€‚
>
> @Target(ElementType.TYPE) çš„æ„æ€å°±æ˜¯æŒ‡å®šè¯¥ Annotation çš„ç±»å‹æ˜¯ ElementType.TYPEã€‚è¿™å°±æ„å‘³ç€ï¼ŒMyAnnotation1 æ˜¯æ¥ä¿®é¥°"ç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨é‡Šç±»å‹ï¼‰æˆ–æšä¸¾å£°æ˜"çš„æ³¨è§£ã€‚
>
> å®šä¹‰ Annotation æ—¶ï¼Œ@Target å¯æœ‰å¯æ— ã€‚è‹¥æœ‰ @Targetï¼Œåˆ™è¯¥ Annotation åªèƒ½ç”¨äºå®ƒæ‰€æŒ‡å®šçš„åœ°æ–¹ï¼›è‹¥æ²¡æœ‰ @Targetï¼Œåˆ™è¯¥ Annotation å¯ä»¥ç”¨äºä»»ä½•åœ°æ–¹ã€‚
>
> **(04) @Retention(RetentionPolicy.RUNTIME)**
>
> å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼ŒRetentionPolicy æ˜¯ Annotation çš„ç­–ç•¥å±æ€§ï¼Œè€Œ @Retention çš„ä½œç”¨ï¼Œå°±æ˜¯æŒ‡å®š Annotation çš„ç­–ç•¥å±æ€§ã€‚
>
> @Retention(RetentionPolicy.RUNTIME) çš„æ„æ€å°±æ˜¯æŒ‡å®šè¯¥ Annotation çš„ç­–ç•¥æ˜¯ RetentionPolicy.RUNTIMEã€‚è¿™å°±æ„å‘³ç€ï¼Œç¼–è¯‘å™¨ä¼šå°†è¯¥ Annotation ä¿¡æ¯ä¿ç•™åœ¨ .class æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯»å–ã€‚
>
> å®šä¹‰ Annotation æ—¶ï¼Œ@Retention å¯æœ‰å¯æ— ã€‚è‹¥æ²¡æœ‰ @Retentionï¼Œåˆ™é»˜è®¤æ˜¯ RetentionPolicy.CLASSã€‚

#### **java å¸¸ç”¨çš„ Annotationï¼š**

```java
@Deprecated  -- @Deprecated æ‰€æ ‡æ³¨å†…å®¹ï¼Œä¸å†è¢«å»ºè®®ä½¿ç”¨ã€‚
@Override    -- @Override åªèƒ½æ ‡æ³¨æ–¹æ³•ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•è¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚
@Documented  -- @Documented æ‰€æ ‡æ³¨å†…å®¹ï¼Œå¯ä»¥å‡ºç°åœ¨javadocä¸­ã€‚
@Inherited   -- @Inheritedåªèƒ½è¢«ç”¨æ¥æ ‡æ³¨â€œAnnotationç±»å‹â€ï¼Œå®ƒæ‰€æ ‡æ³¨çš„Annotationå…·æœ‰ç»§æ‰¿æ€§ã€‚
@Retention   -- @Retentionåªèƒ½è¢«ç”¨æ¥æ ‡æ³¨â€œAnnotationç±»å‹â€ï¼Œè€Œä¸”å®ƒè¢«ç”¨æ¥æŒ‡å®šAnnotationçš„RetentionPolicyå±æ€§ã€‚
@Target      -- @Targetåªèƒ½è¢«ç”¨æ¥æ ‡æ³¨â€œAnnotationç±»å‹â€ï¼Œè€Œä¸”å®ƒè¢«ç”¨æ¥æŒ‡å®šAnnotationçš„ElementTypeå±æ€§ã€‚
@SuppressWarnings -- @SuppressWarnings æ‰€æ ‡æ³¨å†…å®¹äº§ç”Ÿçš„è­¦å‘Šï¼Œç¼–è¯‘å™¨ä¼šå¯¹è¿™äº›è­¦å‘Šä¿æŒé™é»˜ã€‚
```

- **@Deprecated**

  @Deprecated çš„å®šä¹‰å¦‚ä¸‹ï¼š

  ```java
  @Documented
  @Retention(RetentionPolicy.RUNTIME)
  public @interface Deprecated {
  }
  ```

  > è¯´æ˜ï¼š
  >
  > - (01) @interface -- å®ƒçš„ç”¨æ¥ä¿®é¥° Deprecatedï¼Œæ„å‘³ç€ Deprecated å®ç°äº† java.lang.annotation.Annotation æ¥å£ï¼›å³ Deprecated å°±æ˜¯ä¸€ä¸ªæ³¨è§£ã€‚ 
  > - (02) @Documented -- å®ƒçš„ä½œç”¨æ˜¯è¯´æ˜è¯¥æ³¨è§£èƒ½å‡ºç°åœ¨ javadoc ä¸­ã€‚
  > - (03) @Retention(RetentionPolicy.RUNTIME) -- å®ƒçš„ä½œç”¨æ˜¯æŒ‡å®š Deprecated çš„ç­–ç•¥æ˜¯ RetentionPolicy.RUNTIMEã€‚è¿™å°±æ„å‘³ç€ï¼Œç¼–è¯‘å™¨ä¼šå°†Deprecated çš„ä¿¡æ¯ä¿ç•™åœ¨ .class æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯»å–ã€‚
  > - (04) @Deprecated æ‰€æ ‡æ³¨å†…å®¹ï¼Œä¸å†è¢«å»ºè®®ä½¿ç”¨ã€‚

#### springå®¹å™¨çš„aop+åå°„ æœºåˆ¶ ä½¿å¾— javaæ³¨è§£ç”Ÿæ•ˆ

```java

import com.ql.entity.LoginUser;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.aspectj.lang.reflect.MethodSignature;
import org.springframework.stereotype.Component;

import java.lang.reflect.Field;
import java.lang.reflect.Method;

/**
 * @author qinlei
 * @email qlanto_147@163.com
 * @date 2020/11/21 11:23
 */
@Aspect
@Component
public class InjectRealNameAspect {

    /**
     * åˆ‡å…¥ç‚¹
     */
    @Pointcut("@annotation(com.ql.aspect.InjectRealName)")
    public void injectPointCut() {

    }

    /**
     * ç¯ç»•æ¨¡å¼
     * @param point
     * @return
     * @throws Throwable
     */
    @Around("injectPointCut()")
    public Object around(ProceedingJoinPoint point) throws Throwable {
        //è·å–è°ƒç”¨æ–¹æ³•ä¼ å…¥çš„å‚æ•°
        Object[] args = point.getArgs();
        MethodSignature signature = (MethodSignature) point.getSignature();
        Method method = signature.getMethod();
        InjectRealName injectRealName = method.getAnnotation(InjectRealName.class);
        //ç¬¬ä¸€ä¸ªå‚æ•°
        //ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯éœ€è¦æ“ä½œçš„å®ä½“ç±»
        int methodType = injectRealName.method();
        //é€šè¿‡shiroè·å–å½“å‰æ“ä½œäººä¿¡æ¯
        // LoginUser sysUser = (LoginUser) SecurityUtils.getSubject().getPrincipal();
        //æ­¤å¤„ç›´æ¥ç»™å‡º
        LoginUser sysUser = new LoginUser("qlanto");
        
        //0æ›´æ–° 1ä¿®æ”¹
        if(methodType == 0){
            InjectRealNameAspect.setPrivateField(args[0],"createBy",sysUser.getRealname());
        }else{
            InjectRealNameAspect.setPrivateField(args[0],"updateBy",sysUser.getRealname());
        }
        //æ‰§è¡Œæ–¹æ³•
        Object result = point.proceed();
        return result;
    }

    /**
     * è®¾ç½®ç§æœ‰æˆå‘˜çš„å€¼
     * @param instance
     * @param fieldName
     * @param value
     * @throws NoSuchFieldException
     * @throws IllegalAccessException
     */
    public static void setPrivateField(Object instance, String fieldName, Object value) throws NoSuchFieldException, IllegalAccessException {
        Field field = instance.getClass().getDeclaredField(fieldName);
        field.setAccessible(true);
        field.set(instance, value);
    }


}
```

#### spring AOPå®ç°åŸç†

AOPå®ç°åŸç†æ˜¯åŠ¨æ€ä»£ç†ï¼Œè®²åˆ°åŠ¨æ€ä»£ç†å°±ä¸å¾—ä¸è¯´ä»£ç†æ¨¡å¼äº†ï¼Œ ä»£ç†æ¨¡å¼çš„å®šä¹‰ï¼šç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ã€‚ä»£ç†åˆåˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†é‡‡ç”¨çš„å°±æ˜¯JDKä»£ç†ã€‚

#### åŠ¨æ€ä»£ç†ã€é™æ€ä»£ç†

##### é™æ€ä»£ç†

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªPersonæ¥å£ã€‚è¿™ä¸ªæ¥å£å°±æ˜¯å­¦ç”Ÿï¼ˆè¢«ä»£ç†ç±»ï¼‰ï¼Œå’Œç­é•¿ï¼ˆä»£ç†ç±»ï¼‰çš„å…¬å…±æ¥å£ï¼Œä»–ä»¬éƒ½æœ‰äº¤ä½œä¸šçš„è¡Œä¸ºã€‚è¿™æ ·ï¼Œå­¦ç”Ÿäº¤ä½œä¸šå°±å¯ä»¥è®©ç­é•¿æ¥ä»£ç†æ‰§è¡Œã€‚

```java
/**
 * Created by Mapei on 2018/11/7
 * åˆ›å»ºpersonæ¥å£
 */
public interface Person {
    //äº¤ä½œä¸š
    void giveTask();
}
```

Studentç±»å®ç°Personæ¥å£ï¼ŒStudentå¯ä»¥å…·ä½“å®æ–½äº¤ä½œä¸šè¿™ä¸ªè¡Œä¸ºã€‚

```java
/**
 * Created by Mapei on 2018/11/7
 */
public class Student implements Person {
    private String name;
    public Student(String name) {
        this.name = name;
    }
 
    public void giveTask() {
        System.out.println(name + "äº¤è¯­æ–‡ä½œä¸š");
    }
}
```

StudentsProxyç±»ï¼Œè¿™ä¸ªç±»ä¹Ÿå®ç°äº†Personæ¥å£ï¼Œä½†æ˜¯è¿˜å¦å¤–æŒæœ‰ä¸€ä¸ªå­¦ç”Ÿç±»å¯¹è±¡ï¼Œé‚£ä¹ˆä»–å¯ä»¥ä»£ç†å­¦ç”Ÿç±»å¯¹è±¡æ‰§è¡Œäº¤ä½œä¸šçš„è¡Œä¸ºã€‚

```java
/**
 * Created by Mapei on 2018/11/7
 * å­¦ç”Ÿä»£ç†ç±»ï¼Œä¹Ÿå®ç°äº†Personæ¥å£ï¼Œä¿å­˜ä¸€ä¸ªå­¦ç”Ÿå®ä½“ï¼Œè¿™æ ·å°±å¯ä»¥ä»£ç†å­¦ç”Ÿäº§ç”Ÿè¡Œä¸º
 */
public class StudentsProxy implements Person{
    //è¢«ä»£ç†çš„å­¦ç”Ÿ
    Student stu;
 
    public StudentsProxy(Person stu) {
        // åªä»£ç†å­¦ç”Ÿå¯¹è±¡
        if(stu.getClass() == Student.class) {
            this.stu = (Student)stu;
        }
    }
 
    //ä»£ç†äº¤ä½œä¸šï¼Œè°ƒç”¨è¢«ä»£ç†å­¦ç”Ÿçš„äº¤ä½œä¸šçš„è¡Œä¸º
    public void giveTask() {
        stu.giveTask();
    }
}
```

ä¸‹é¢æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹ä»£ç†æ¨¡å¼å¦‚ä½•ä½¿ç”¨ï¼š

```java
/**
 * Created by Mapei on 2018/11/7
 */
public class StaticProxyTest {
    public static void main(String[] args) {
        //è¢«ä»£ç†çš„å­¦ç”Ÿæ—æµ…ï¼Œä»–çš„ä½œä¸šä¸Šäº¤æœ‰ä»£ç†å¯¹è±¡monitorå®Œæˆ
        Person linqian = new Student("æ—æµ…");
 
        //ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œå¹¶å°†æ—æµ…ä¼ ç»™ä»£ç†å¯¹è±¡
        Person monitor = new StudentsProxy(linqian);
 
        //ç­é•¿ä»£ç†äº¤ä½œä¸š
        monitor.giveTask();
    }
}
```

> è¿™é‡Œå¹¶æ²¡æœ‰ç›´æ¥é€šè¿‡æ—æµ…ï¼ˆè¢«ä»£ç†å¯¹è±¡ï¼‰æ¥æ‰§è¡Œäº¤ä½œä¸šçš„è¡Œä¸ºï¼Œè€Œæ˜¯é€šè¿‡ç­é•¿ï¼ˆä»£ç†å¯¹è±¡ï¼‰æ¥ä»£ç†æ‰§è¡Œäº†ã€‚è¿™å°±æ˜¯ä»£ç†æ¨¡å¼ã€‚ä»£ç†æ¨¡å¼å°±æ˜¯åœ¨è®¿é—®å®é™…å¯¹è±¡æ—¶å¼•å…¥ä¸€å®šç¨‹åº¦çš„é—´æ¥æ€§ï¼Œè¿™é‡Œçš„é—´æ¥æ€§å°±æ˜¯æŒ‡ä¸ç›´æ¥è°ƒç”¨å®é™…å¯¹è±¡çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä»£ç†è¿‡ç¨‹ä¸­å°±å¯ä»¥åŠ ä¸Šä¸€äº›å…¶ä»–ç”¨é€”ã€‚æ¯”å¦‚ç­é•¿åœ¨å¸®æ—æµ…äº¤ä½œä¸šçš„æ—¶å€™æƒ³å‘Šè¯‰è€å¸ˆæœ€è¿‘æ—æµ…çš„è¿›æ­¥å¾ˆå¤§ï¼Œå°±å¯ä»¥è½»æ¾çš„é€šè¿‡ä»£ç†æ¨¡å¼åŠåˆ°ã€‚åœ¨ä»£ç†ç±»çš„äº¤ä½œä¸šä¹‹å‰åŠ å…¥æ–¹æ³•å³å¯ã€‚è¿™ä¸ªä¼˜ç‚¹å°±å¯ä»¥è¿ç”¨åœ¨springä¸­çš„AOPï¼Œæˆ‘ä»¬èƒ½åœ¨ä¸€ä¸ªåˆ‡ç‚¹ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œï¼Œåœ¨ä¸€ä¸ªåˆ‡ç‚¹ä¹‹åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œè¿™ä¸ªåˆ‡ç‚¹å°±æ˜¯ä¸€ä¸ªä¸ªæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ‰€åœ¨ç±»è‚¯å®šå°±æ˜¯è¢«ä»£ç†äº†ï¼Œåœ¨ä»£ç†è¿‡ç¨‹ä¸­åˆ‡å…¥äº†ä¸€äº›å…¶ä»–æ“ä½œã€‚

##### åŠ¨æ€ä»£ç†

>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†çš„åŒºåˆ«æ˜¯ï¼Œé™æ€ä»£ç†çš„çš„ä»£ç†ç±»æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰å¥½çš„ï¼Œåœ¨ç¨‹åºè¿è¡Œä¹‹å‰å°±å·²ç»å˜å¼‚å®Œæˆï¼Œä½†æ˜¯åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºçš„ã€‚ç›¸æ¯”äºé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¹ä»£ç†ç±»çš„å‡½æ•°è¿›è¡Œç»Ÿä¸€çš„å¤„ç†ï¼Œè€Œä¸ç”¨ä¿®æ”¹æ¯ä¸ªä»£ç†ç±»ä¸­çš„æ–¹æ³•ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³åœ¨æ¯ä¸ªä»£ç†æ–¹æ³•ä¹‹å‰éƒ½åŠ ä¸€ä¸ªå¤„ç†æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­åªæœ‰ä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œå¦‚æœè¿˜æœ‰å¾ˆå¤šçš„ä»£ç†æ–¹æ³•ï¼Œå°±å¤ªéº»çƒ¦äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹åŠ¨æ€ä»£ç†æ˜¯æ€ä¹ˆå»å®ç°çš„ã€‚

é¦–å…ˆè¿˜æ˜¯å®šä¹‰ä¸€ä¸ªPersonæ¥å£:

```java
/**
 * Created by Mapei on 2018/11/7
 * åˆ›å»ºpersonæ¥å£
 */
public interface Person {
    //äº¤ä½œä¸š
    void giveTask();
}
```

æ¥ä¸‹æ¥æ˜¯åˆ›å»ºéœ€è¦è¢«ä»£ç†çš„å®é™…ç±»ï¼Œä¹Ÿå°±æ˜¯å­¦ç”Ÿç±»ï¼š

```java

/**
 * Created by Mapei on 2018/11/7
 */
public class Student implements Person {
    private String name;
    public Student(String name) {
        this.name = name;
    }
 
    public void giveTask() {
        System.out.println(name + "äº¤è¯­æ–‡ä½œä¸š");
    }
}
```

åˆ›å»ºStuInvocationHandlerç±»ï¼Œå®ç°InvocationHandleræ¥å£ï¼Œè¿™ä¸ªç±»ä¸­æŒæœ‰ä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„å®ä¾‹targetã€‚InvocationHandlerä¸­æœ‰ä¸€ä¸ªinvokeæ–¹æ³•ï¼Œæ‰€æœ‰æ‰§è¡Œä»£ç†å¯¹è±¡çš„æ–¹æ³•éƒ½ä¼šè¢«æ›¿æ¢æˆæ‰§è¡Œinvokeæ–¹æ³•ã€‚

```java

/**
 * Created by Mapei on 2018/11/7
 */
public class StuInvocationHandler<T> implements InvocationHandler {
    //invocationHandleræŒæœ‰çš„è¢«ä»£ç†å¯¹è±¡
    T target;
 
    public StuInvocationHandler(T target) {
        this.target = target;
    }
 
    /**
     * proxy:ä»£è¡¨åŠ¨æ€ä»£ç†å¯¹è±¡
     * methodï¼šä»£è¡¨æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•
     * argsï¼šä»£è¡¨è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ä¼ å…¥çš„å®å‚
     */
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println("ä»£ç†æ‰§è¡Œ" +method.getName() + "æ–¹æ³•");
        Object result = method.invoke(target, args);
        return result;
    }
}
```

é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å…·ä½“çš„åˆ›å»ºä»£ç†å¯¹è±¡äº†ã€‚

```java
/**
 * Created by Mapei on 2018/11/7
 * ä»£ç†ç±»
 */
public class ProxyTest {
    public static void main(String[] args) {
 
        //åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯è¢«ä»£ç†çš„å¯¹è±¡
        Person linqian = new Student("æ—æµ…");
 
        //åˆ›å»ºä¸€ä¸ªä¸ä»£ç†å¯¹è±¡ç›¸å…³è”çš„InvocationHandler
        InvocationHandler stuHandler = new StuInvocationHandler<Person>(linqian);
 
        //åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡stuProxyæ¥ä»£ç†linqianï¼Œä»£ç†å¯¹è±¡çš„æ¯ä¸ªæ‰§è¡Œæ–¹æ³•éƒ½ä¼šæ›¿æ¢æ‰§è¡ŒInvocationä¸­çš„invokeæ–¹æ³•
        Person stuProxy = (Person) Proxy.newProxyInstance(Person.class.getClassLoader(), new Class<?>[]{Person.class}, stuHandler);
 
        //ä»£ç†æ‰§è¡Œäº¤ä½œä¸šçš„æ–¹æ³•
        stuProxy.giveTask();
    }
}
```

é‚£ä¹ˆåˆ°è¿™é‡Œé—®é¢˜å°±æ¥äº†ï¼Œä¸ºä»€ä¹ˆä»£ç†å¯¹è±¡æ‰§è¡Œçš„æ–¹æ³•éƒ½ä¼šé€šè¿‡InvocationHandlerä¸­çš„invokeæ–¹æ³•æ¥æ‰§è¡Œï¼Œå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹åŠ¨æ€ä»£ç†çš„æºç ï¼Œå¯¹ä»–è¿›è¡Œç®€å•çš„åˆ†æã€‚

ä¸Šé¢æˆ‘ä»¬ä½¿ç”¨Proxyç±»çš„newProxyInstanceæ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œçœ‹ä¸€ä¸‹ä»–çš„æºç ï¼š

```java
public static Object newProxyInstance(ClassLoader loader, Class<?>[] interfaces, InvocationHandler h)
        throws IllegalArgumentException
    {
        Objects.requireNonNull(h);
 
        final Class<?>[] intfs = interfaces.clone();
        final SecurityManager sm = System.getSecurityManager();
        if (sm != null) {
            checkProxyAccess(Reflection.getCallerClass(), loader, intfs);
        }
 
        /*
         * Look up or generate the designated proxy class.
         */
        Class<?> cl = getProxyClass0(loader, intfs);
 
        /*
         * Invoke its constructor with the designated invocation handler.
         */
        try {
            if (sm != null) {
                checkNewProxyPermission(Reflection.getCallerClass(), cl);
            }
 
            final Constructor<?> cons = cl.getConstructor(constructorParams);
            final InvocationHandler ih = h;
            if (!Modifier.isPublic(cl.getModifiers())) {
                AccessController.doPrivileged(new PrivilegedAction<Void>() {
                    public Void run() {
                        cons.setAccessible(true);
                        return null;
                    }
                });
            }
            return cons.newInstance(new Object[]{h});
        } catch (IllegalAccessException|InstantiationException e) {
            throw new InternalError(e.toString(), e);
        } catch (InvocationTargetException e) {
            Throwable t = e.getCause();
            if (t instanceof RuntimeException) {
                throw (RuntimeException) t;
            } else {
                throw new InternalError(t.toString(), t);
            }
        } catch (NoSuchMethodException e) {
            throw new InternalError(e.toString(), e);
        }
  }
```

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨Class<?> cl = getProxyClass0(loader, intfs)è¿™å¥ä»£ç ï¼Œè¿™é‡Œäº§ç”Ÿäº†ä»£ç†ç±»ï¼Œè¿™ä¸ªç±»å°±æ˜¯åŠ¨æ€ä»£ç†çš„å…³é”®ï¼Œç”±äºæ˜¯åŠ¨æ€ç”Ÿæˆçš„ç±»æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªç±»æ–‡ä»¶æ‰“å°åˆ°æ–‡ä»¶ä¸­ã€‚

```java

        byte[] classFile = ProxyGenerator.generateProxyClass("$Proxy0", Student.class.getInterfaces());
        String path = "/Users/mapei/Desktop/okay/65707.class";
 
        try{
            FileOutputStream fos = new FileOutputStream(path);
            fos.write(classFile);
            fos.flush();
            System.out.println("ä»£ç†ç±»classæ–‡ä»¶å†™å…¥æˆåŠŸ");
        }catch (Exception e) {
            System.out.println("å†™æ–‡ä»¶é”™è¯¯");
        }
```

å¯¹è¿™ä¸ªclassæ–‡ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œæˆ‘ä»¬çœ‹çœ‹jdkä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä»€ä¹ˆæ ·çš„å†…å®¹ï¼š

```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.lang.reflect.UndeclaredThrowableException;
import proxy.Person;
 
public final class $Proxy0 extends Proxy implements Person
{
  private static Method m1;
  private static Method m2;
  private static Method m3;
  private static Method m0;
  
  /**
  *æ³¨æ„è¿™é‡Œæ˜¯ç”Ÿæˆä»£ç†ç±»çš„æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•å‚æ•°ä¸ºInvocationHandlerç±»å‹ï¼Œçœ‹åˆ°è¿™ï¼Œæ˜¯ä¸æ˜¯å°±æœ‰ç‚¹æ˜ç™½
  *ä¸ºä½•ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•éƒ½æ˜¯æ‰§è¡ŒInvocationHandlerä¸­çš„invokeæ–¹æ³•ï¼Œè€ŒInvocationHandleråˆæŒæœ‰ä¸€ä¸ª
  *è¢«ä»£ç†å¯¹è±¡çš„å®ä¾‹ï¼Œå°±å¯ä»¥å»è°ƒç”¨çœŸæ­£çš„å¯¹è±¡å®ä¾‹ã€‚
  */
  public $Proxy0(InvocationHandler paramInvocationHandler)
    throws 
  {
    super(paramInvocationHandler);
  }
  
  //è¿™ä¸ªé™æ€å—æœ¬æ¥æ˜¯åœ¨æœ€åçš„ï¼Œæˆ‘æŠŠå®ƒæ‹¿åˆ°å‰é¢æ¥ï¼Œæ–¹ä¾¿æè¿°
   static
  {
    try
    {
      //çœ‹çœ‹è¿™å„¿é™æ€å—å„¿é‡Œé¢çš„ä½giveTaské€šè¿‡åå°„å¾—åˆ°çš„åå­—m3ï¼Œå…¶ä»–çš„å…ˆä¸ç®¡
      m1 = Class.forName("java.lang.Object").getMethod("equals", new Class[] { Class.forName("java.lang.Object") });
      m2 = Class.forName("java.lang.Object").getMethod("toString", new Class[0]);
      m3 = Class.forName("proxy.Person").getMethod("giveTask", new Class[0]);
      m0 = Class.forName("java.lang.Object").getMethod("hashCode", new Class[0]);
      return;
    }
    catch (NoSuchMethodException localNoSuchMethodException)
    {
      throw new NoSuchMethodError(localNoSuchMethodException.getMessage());
    }
    catch (ClassNotFoundException localClassNotFoundException)
    {
      throw new NoClassDefFoundError(localClassNotFoundException.getMessage());
    }
  }
 
  /**
  * 
  *è¿™é‡Œè°ƒç”¨ä»£ç†å¯¹è±¡çš„giveMoneyæ–¹æ³•ï¼Œç›´æ¥å°±è°ƒç”¨äº†InvocationHandlerä¸­çš„invokeæ–¹æ³•ï¼Œå¹¶æŠŠm3ä¼ äº†è¿›å»ã€‚
  *this.h.invoke(this, m3, null);æˆ‘ä»¬å¯ä»¥å¯¹å°†InvocationHandlerçœ‹åšä¸€ä¸ªä¸­ä»‹ç±»ï¼Œä¸­ä»‹ç±»æŒæœ‰ä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡ï¼Œåœ¨invokeæ–¹æ³•ä¸­è°ƒç”¨äº†è¢«ä»£ç†å¯¹è±¡çš„ç›¸åº”æ–¹æ³•ã€‚é€šè¿‡èšåˆæ–¹å¼æŒæœ‰è¢«ä»£ç†å¯¹è±¡çš„å¼•ç”¨ï¼ŒæŠŠå¤–éƒ¨å¯¹invokeçš„è°ƒç”¨æœ€ç»ˆéƒ½è½¬ä¸ºå¯¹è¢«ä»£ç†å¯¹è±¡çš„è°ƒç”¨ã€‚
  */
  public final void giveTask()
    throws 
  {
    try
    {
      this.h.invoke(this, m3, null);
      return;
    }
    catch (Error|RuntimeException localError)
    {
      throw localError;
    }
    catch (Throwable localThrowable)
    {
      throw new UndeclaredThrowableException(localThrowable);
    }
  }
 
}
```

##### AOPå®ç°

çœ‹å®Œäº†åŠ¨æ€ä»£ç†çš„æºç ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦çœ‹ä¸€ä¸‹Springä¸­AOPå®ç°çš„æºç æ˜¯æ€æ ·çš„ï¼Ÿ

***aopåˆ›å»ºä»£ç†çš„æºç åˆ†æ***

çœ‹ä¸€ä¸‹beanå¦‚ä½•è¢«åŒ…è£…ä¸ºproxyï¼š

```java
protected Object createProxy(
   		Class<?> beanClass, String beanName, Object[] specificInterceptors, TargetSource targetSource) {
   		
   	if (this.beanFactory instanceof ConfigurableListableBeanFactory) {
   		AutoProxyUtils.exposeTargetClass((ConfigurableListableBeanFactory) this.beanFactory, beanName, beanClass);
   	}
 
       // 1.åˆ›å»ºproxyFactoryï¼Œproxyçš„ç”Ÿäº§ä¸»è¦å°±æ˜¯åœ¨proxyFactoryåšçš„
   	ProxyFactory proxyFactory = new ProxyFactory();
   	proxyFactory.copyFrom(this);
 
   	if (!proxyFactory.isProxyTargetClass()) {
   		if (shouldProxyTargetClass(beanClass, beanName)) {
   			proxyFactory.setProxyTargetClass(true);
   		}
   		else {
   			evaluateProxyInterfaces(beanClass, proxyFactory);
   		}
   	}
 
       // 2.å°†å½“å‰beané€‚åˆçš„adviceï¼Œé‡æ–°å°è£…ä¸‹ï¼Œå°è£…ä¸ºAdvisorç±»ï¼Œç„¶åæ·»åŠ åˆ°ProxyFactoryä¸­
   	Advisor[] advisors = buildAdvisors(beanName, specificInterceptors);
   	for (Advisor advisor : advisors) {
   		proxyFactory.addAdvisor(advisor);
   	}
 
   	proxyFactory.setTargetSource(targetSource);
   	customizeProxyFactory(proxyFactory);
 
   	proxyFactory.setFrozen(this.freezeProxy);
   	if (advisorsPreFiltered()) {
   		proxyFactory.setPreFiltered(true);
   	}
 
       // 3.è°ƒç”¨getProxyè·å–beanå¯¹åº”çš„proxy
   	return proxyFactory.getProxy(getProxyClassLoader());
   }
```

åˆ›å»ºä½•ç§ç±»å‹çš„Proxyï¼ŸJDKProxyè¿˜æ˜¯CGLIBProxyï¼Ÿ

```java

	public Object getProxy(ClassLoader classLoader) {
		return createAopProxy().getProxy(classLoader);
	}
    // createAopProxy()æ–¹æ³•å°±æ˜¯å†³å®šç©¶ç«Ÿåˆ›å»ºä½•ç§ç±»å‹çš„proxy
	protected final synchronized AopProxy createAopProxy() {
		if (!this.active) {
			activate();
		}
        // å…³é”®æ–¹æ³•createAopProxy()
		return getAopProxyFactory().createAopProxy(this);
	}
	
    // createAopProxy()
	public AopProxy createAopProxy(AdvisedSupport config) throws AopConfigException {
        // 1.config.isOptimize()æ˜¯å¦ä½¿ç”¨ä¼˜åŒ–çš„ä»£ç†ç­–ç•¥ï¼Œç›®å‰ä½¿ç”¨ä¸CGLIB
        // config.isProxyTargetClass() æ˜¯å¦ç›®æ ‡ç±»æœ¬èº«è¢«ä»£ç†è€Œä¸æ˜¯ç›®æ ‡ç±»çš„æ¥å£
        // hasNoUserSuppliedProxyInterfaces()æ˜¯å¦å­˜åœ¨ä»£ç†æ¥å£
		if (config.isOptimize() || config.isProxyTargetClass() || hasNoUserSuppliedProxyInterfaces(config)) {
			Class<?> targetClass = config.getTargetClass();
			if (targetClass == null) {
				throw new AopConfigException("TargetSource cannot determine target class: " +
						"Either an interface or a target is required for proxy creation.");
			}
            
            // 2.å¦‚æœç›®æ ‡ç±»æ˜¯æ¥å£ç±»ï¼ˆç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼‰ï¼Œåˆ™ç›´æ¥ä½¿ç”¨JDKproxy
			if (targetClass.isInterface() || Proxy.isProxyClass(targetClass)) {
				return new JdkDynamicAopProxy(config);
			}
            
            // 3.å…¶ä»–æƒ…å†µåˆ™ä½¿ç”¨CGLIBproxy
			return new ObjenesisCglibAopProxy(config);
		}
		else {
			return new JdkDynamicAopProxy(config);
		}
	}
```

getProxy()æ–¹æ³•

```java

   final class JdkDynamicAopProxy implements AopProxy, InvocationHandler, Serializable// JdkDynamicAopProxyç±»ç»“æ„ï¼Œç”±æ­¤å¯çŸ¥ï¼Œå…¶å®ç°äº†InvocationHandlerï¼Œåˆ™å¿…å®šæœ‰invokeæ–¹æ³•ï¼Œæ¥è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·è°ƒç”¨beanç›¸å…³æ–¹æ³•æ—¶ï¼Œæ­¤invoke()è¢«çœŸæ­£è°ƒç”¨
   // getProxy()
   public Object getProxy(ClassLoader classLoader) {
   	if (logger.isDebugEnabled()) {
   		logger.debug("Creating JDK dynamic proxy: target source is " + this.advised.getTargetSource());
   	}
   	Class<?>[] proxiedInterfaces = AopProxyUtils.completeProxiedInterfaces(this.advised, true);
   	findDefinedEqualsAndHashCodeMethods(proxiedInterfaces);
       
       // JDK proxy åŠ¨æ€ä»£ç†çš„æ ‡å‡†ç”¨æ³•
   	return Proxy.newProxyInstance(classLoader, proxiedInterfaces, this);
   }
```

invoke()æ–¹æ³•

```java

    //ä½¿ç”¨äº†JDKåŠ¨æ€ä»£ç†æ¨¡å¼ï¼ŒçœŸæ­£çš„æ–¹æ³•æ‰§è¡Œåœ¨invoke()æ–¹æ³•é‡Œï¼Œçœ‹åˆ°è¿™é‡Œåœ¨æƒ³ä¸€ä¸‹ä¸Šé¢åŠ¨æ€ä»£ç†çš„ä¾‹å­ï¼Œæ˜¯ä¸æ˜¯å°±å®Œå…¨æ˜ç™½Springæºç å®ç°åŠ¨æ€ä»£ç†çš„åŸç†äº†ã€‚
			public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
		MethodInvocation invocation;
		Object oldProxy = null;
		boolean setProxyContext = false;
 
		TargetSource targetSource = this.advised.targetSource;
		Class<?> targetClass = null;
		Object target = null;
 
		try {
            // 1.ä»¥ä¸‹çš„å‡ ä¸ªåˆ¤æ–­ï¼Œä¸»è¦æ˜¯ä¸ºäº†åˆ¤æ–­methodæ˜¯å¦ä¸ºequalsã€hashCodeç­‰Objectçš„æ–¹æ³•
			if (!this.equalsDefined && AopUtils.isEqualsMethod(method)) {
				// The target does not implement the equals(Object) method itself.
				return equals(args[0]);
			}
			else if (!this.hashCodeDefined && AopUtils.isHashCodeMethod(method)) {
				// The target does not implement the hashCode() method itself.
				return hashCode();
			}
			else if (method.getDeclaringClass() == DecoratingProxy.class) {
				// There is only getDecoratedClass() declared -> dispatch to proxy config.
				return AopProxyUtils.ultimateTargetClass(this.advised);
			}
			else if (!this.advised.opaque && method.getDeclaringClass().isInterface() &&
					method.getDeclaringClass().isAssignableFrom(Advised.class)) {
				// Service invocations on ProxyConfig with the proxy config...
				return AopUtils.invokeJoinpointUsingReflection(this.advised, method, args);
			}
 
			Object retVal;
 
			if (this.advised.exposeProxy) {
				// Make invocation available if necessary.
				oldProxy = AopContext.setCurrentProxy(proxy);
				setProxyContext = true;
			}
 
			// May be null. Get as late as possible to minimize the time we "own" the target,
			// in case it comes from a pool.
			target = targetSource.getTarget();
			if (target != null) {
				targetClass = target.getClass();
			}
			// 2.è·å–å½“å‰beanè¢«æ‹¦æˆªæ–¹æ³•é“¾è¡¨
			List<Object> chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass);
 
			// 3.å¦‚æœä¸ºç©ºï¼Œåˆ™ç›´æ¥è°ƒç”¨targetçš„method
			if (chain.isEmpty()) {
				Object[] argsToUse = AopProxyUtils.adaptArgumentsIfNecessary(method, args);
				retVal = AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse);
			}
            // 4.ä¸ä¸ºç©ºï¼Œåˆ™é€ä¸€è°ƒç”¨chainä¸­çš„æ¯ä¸€ä¸ªæ‹¦æˆªæ–¹æ³•çš„proceedï¼Œè¿™é‡Œçš„ä¸€ç³»åˆ—æ‰§è¡Œçš„åŸå› ä»¥åŠproceedæ‰§è¡Œçš„å†…å®¹ï¼Œæˆ‘ åœ¨è¿™é‡Œå°±ä¸è¯¦ç»†è®²äº†ï¼Œå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±å»ç ”è¯»å“ˆ
			else {
				// We need to create a method invocation...
				invocation = new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain);
				// Proceed to the joinpoint through the interceptor chain.
				retVal = invocation.proceed();
			}
 
			...
			return retVal;
		}
	}
	}
```

### å¼‚å¸¸å¤„ç†

javaå¼‚å¸¸ç±»çš„ç»“æ„å±‚æ¬¡å›¾ï¼š

![javaå¼‚å¸¸](/img/javaå¼‚å¸¸.jpg)

> åœ¨Javaä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸ç±»çš„çˆ¶ç±»æ˜¯Throwableç±»ï¼ŒErrorç±»æ˜¯errorç±»å‹å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒExceptionç±»æ˜¯exceptionç±»å‹å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒRuntimeExceptionç±»æ˜¯æ‰€æœ‰è¿è¡Œæ—¶å¼‚å¸¸çš„çˆ¶ç±»ï¼ŒRuntimeExceptionä»¥å¤–çš„å¹¶ä¸”ç»§æ‰¿Exceptionçš„ç±»æ˜¯éè¿è¡Œæ—¶å¼‚å¸¸ã€‚
>
> ã€€ã€€å…¸å‹çš„RuntimeExceptionåŒ…æ‹¬NullPointerExceptionã€IndexOutOfBoundsExceptionã€IllegalArgumentExceptionç­‰ã€‚
>
> ã€€ã€€å…¸å‹çš„éRuntimeExceptionåŒ…æ‹¬IOExceptionã€SQLExceptionç­‰ã€‚

### IO æµ

https://www.cnblogs.com/wugongzi/p/12092326.html

***IOæµä¸»è¦æ˜¯ç”¨äºæ“ä½œæ–‡ä»¶***

IOæµæ€»è§ˆï¼š

![IOæµæ€»è§ˆ](/img/IOæµæ€»è§ˆ.png)

java IOç³»ç»Ÿ

![IOç³»ç»Ÿ](/img/IOç³»ç»Ÿ.jpg)

- å­—ç¬¦æµ

  - Writeræ˜¯å­—ç¬¦è¾“å‡ºæµçš„åŸºç±»ï¼ŒWriterçš„ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

    > ```java
    > Writer append(char c) å°†æŒ‡å®šçš„å­—ç¬¦é™„åŠ åˆ°æ­¤ä½œè€…
    > Writer append(CharSequence csq) å°†æŒ‡å®šçš„å­—ç¬¦åºåˆ—é™„åŠ åˆ°æ­¤ä½œè€…
    > Writer append(CharSequence csq, int start, int end) å°†æŒ‡å®šå­—ç¬¦åºåˆ—çš„å­åºåˆ—é™„åŠ åˆ°æ­¤ä½œwriter
    > abstract void close() å…³é—­æµï¼Œå…ˆåˆ·æ–°
    > abstract void flush() åˆ·æ–°æµ 
    > void write(char[] cbuf) å†™å…¥ä¸€ä¸ªå­—ç¬¦æ•°ç»„ã€‚ 
    > abstract void write(char[] cbuf, int off, int len) å†™å…¥å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ† 
    > void write(int c) å†™ä¸€ä¸ªå­—ç¬¦ 
    > void write(String str) å†™ä¸€ä¸ªå­—ç¬¦ä¸² 
    > void write(String str, int off, int len) å†™ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
    > ```

  - FileWriter

    - FileWriteræ„é€ æ–¹æ³•

      > ```java
      > OutputStreamWriter(OutputStream out) åˆ›å»ºä¸€ä¸ªä½¿ç”¨é»˜è®¤å­—ç¬¦ç¼–ç çš„OutputStreamWriter
      > OutputStreamWriter(OutputStream out, String charsetName) åˆ›å»ºä¸€ä¸ªä½¿ç”¨å‘½åå­—ç¬¦é›†çš„OutputStreamWriter
      > OutputStreamWriter(OutputStream out, Charset cs) åˆ›å»ºä¸€ä¸ªä½¿ç”¨ç»™å®šå­—ç¬¦é›†çš„OutputStreamWriter
      > OutputStreamWriter(OutputStream out, CharsetEncoder enc) åˆ›å»ºä¸€ä¸ªä½¿ç”¨ç»™å®šå­—ç¬¦é›†ç¼–ç å™¨çš„OutputStreamWriter
      > ```

    - FileWriteræ–¹æ³•åˆ—è¡¨

      > ```java
      > Writer appendâ€‹(CharSequence csq) å°†æŒ‡å®šçš„å­—ç¬¦åºåˆ—é™„åŠ åˆ°æ­¤ä½œè€…ã€‚ 
      > Writer appendâ€‹(CharSequence csq, int start, int end) å°†æŒ‡å®šå­—ç¬¦åºåˆ—çš„å­åºåˆ—é™„åŠ åˆ°æ­¤ä½œè€…ã€‚ 
      > void closeâ€‹() å…³é—­æµï¼Œå…ˆåˆ·æ–°ã€‚ 
      > void flushâ€‹() åˆ·æ–°æµã€‚ 
      > String getEncodingâ€‹() è¿”å›æ­¤æµä½¿ç”¨çš„å­—ç¬¦ç¼–ç çš„åç§°ã€‚ 
      > void writeâ€‹(char[] cbuf, int off, int len) å†™å…¥å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ†ã€‚ 
      > void writeâ€‹(int c) å†™ä¸€ä¸ªå­—ç¬¦ 
      > void writeâ€‹(String str, int off, int len) å†™ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚
      > ```

  - å…¶ä»–

    - BufferedWriter æ˜¯ç¼“å†²å­—ç¬¦è¾“å‡ºæµã€‚å®ƒç»§æ‰¿äºWriter
    - CharArrayReader ç”¨äºå†™å…¥å­—ç¬¦ï¼Œå®ƒç»§æ‰¿äºWriterã€‚æ“ä½œçš„æ•°æ®æ˜¯ä»¥å­—ç¬¦ä¸ºå•ä½ï¼
    - FilterWriteræ˜¯å­—ç¬¦ç±»å‹çš„è¿‡æ»¤è¾“å‡ºæµ
    - PrintWriter æ˜¯å­—ç¬¦ç±»å‹çš„æ‰“å°è¾“å‡ºæµï¼Œå®ƒç»§æ‰¿äºWriterã€‚

- Readerå­—ç¬¦è¾“å…¥æµ

  æœ‰è¾“å‡ºæµé‚£ä¹ˆå½“ç„¶å°±æœ‰è¾“å…¥æµï¼ŒReaderæ˜¯å­—ç¬¦è¾“å…¥æµçš„åŸºç±»ï¼ŒReaderçš„æ–¹æ³•åˆ—è¡¨å¦‚ä¸‹ï¼š

  > ```java
  > abstract void closeâ€‹() å…³é—­æµå¹¶é‡Šæ”¾ä¸ä¹‹ç›¸å…³è”çš„ä»»ä½•ç³»ç»Ÿèµ„æºã€‚ 
  > void markâ€‹(int readAheadLimit) æ ‡è®°æµä¸­çš„å½“å‰ä½ç½®ã€‚ 
  > boolean markSupportedâ€‹() å‘Šè¯‰è¿™ä¸ªæµæ˜¯å¦æ”¯æŒmarkï¼ˆï¼‰æ“ä½œã€‚ 
  > int readâ€‹() è¯»ä¸€ä¸ªå­—ç¬¦ 
  > int readâ€‹(char[] cbuf) å°†å­—ç¬¦è¯»å…¥æ•°ç»„ã€‚ 
  > abstract int readâ€‹(char[] cbuf, int off, int len) å°†å­—ç¬¦è¯»å…¥æ•°ç»„çš„ä¸€éƒ¨åˆ†ã€‚ 
  > int readâ€‹(CharBuffer target) å°è¯•å°†å­—ç¬¦è¯»å…¥æŒ‡å®šçš„å­—ç¬¦ç¼“å†²åŒºã€‚ 
  > boolean readyâ€‹() å‘Šè¯‰è¿™ä¸ªæµæ˜¯å¦å‡†å¤‡å¥½è¢«è¯»å–ã€‚ 
  > void resetâ€‹() é‡ç½®æµã€‚ 
  > long skipâ€‹(long n) è·³è¿‡å­—ç¬¦ 
  > ```

  ç±»å‹ï¼š

  - FileReader
  - BufferedReader

- å­—èŠ‚æµ

  å­—èŠ‚æµçš„åŸºæœ¬æ“ä½œå’Œå­—ç¬¦æµç±»ç›¸åŒï¼Œä½†å®ƒä¸ä»…å¯ä»¥æ“ä½œå­—ç¬¦ï¼Œè¿˜å¯ä»¥æ“ä½œå…¶ä»–åª’ä½“æ–‡ä»¶ã€‚

  - InputStreamç±»æ˜¯å­—èŠ‚è¾“å…¥æµçš„æŠ½è±¡ç±»ï¼Œæ˜¯æ‰€æœ‰å­—èŠ‚è¾“å…¥æµçš„çˆ¶ç±»

    > InputStreamçš„å¸¸ç”¨æ–¹æ³•ï¼š
    >
    > ```java
    > int availableâ€‹() ä»ä¸‹ä¸€æ¬¡è°ƒç”¨æ­¤è¾“å…¥æµçš„æ–¹æ³•è¿”å›å¯ä»è¯¥è¾“å…¥æµè¯»å–ï¼ˆæˆ–è·³è¿‡ï¼‰çš„å­—èŠ‚æ•°ï¼Œè€Œä¸ä¼šé˜»å¡ã€‚ 
    > void closeâ€‹() å…³é—­æ­¤è¾“å…¥æµå¹¶é‡Šæ”¾ä¸æµç›¸å…³è”çš„ä»»ä½•ç³»ç»Ÿèµ„æºã€‚ 
    > void markâ€‹(int readlimit) æ ‡è®°æ­¤è¾“å…¥æµä¸­çš„å½“å‰ä½ç½®ã€‚ 
    > boolean markSupportedâ€‹() æµ‹è¯•æ­¤è¾“å…¥æµæ˜¯å¦æ”¯æŒ markå’Œ resetæ–¹æ³•ã€‚ 
    > abstract int readâ€‹() ä»è¾“å…¥æµè¯»å–æ•°æ®çš„ä¸‹ä¸€ä¸ªå­—èŠ‚ã€‚ 
    > int readâ€‹(byte[] b) ä»è¾“å…¥æµä¸­è¯»å–ä¸€äº›å­—èŠ‚æ•°ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åˆ°ç¼“å†²å™¨é˜µåˆ— b ã€‚ 
    > int readâ€‹(byte[] b, int off, int len) ä»è¾“å…¥æµè¯»å–æœ€å¤š lenä¸ªå­—èŠ‚çš„æ•°æ®åˆ°å­—èŠ‚æ•°ç»„ã€‚ 
    > byte[] readAllBytesâ€‹() ä»è¾“å…¥æµè¯»å–æ‰€æœ‰å‰©ä½™å­—èŠ‚ã€‚ 
    > int readNBytesâ€‹(byte[] b, int off, int len) å°†æ‰€è¯·æ±‚çš„å­—èŠ‚æ•°ä»è¾“å…¥æµè¯»å…¥ç»™å®šçš„å­—èŠ‚æ•°ç»„ã€‚ 
    > void resetâ€‹() å°†æ­¤æµé‡æ–°å®šä½åˆ°æœ€ååœ¨æ­¤è¾“å…¥æµä¸Šè°ƒç”¨ markæ–¹æ³•æ—¶çš„ä½ç½®ã€‚ 
    > long skipâ€‹(long n) è·³è¿‡å¹¶ä¸¢å¼ƒæ¥è‡ªæ­¤è¾“å…¥æµçš„ nå­—èŠ‚çš„æ•°æ®ã€‚ 
    > long transferToâ€‹(OutputStream out) ä»è¯¥è¾“å…¥æµä¸­è¯»å–æ‰€æœ‰å­—èŠ‚ï¼Œå¹¶æŒ‰è¯»å–çš„é¡ºåºå°†å­—èŠ‚å†™å…¥ç»™å®šçš„è¾“å‡ºæµã€‚
    > ```

    - FileInputStream

  - OutputStream
    - FileOutputStream

  

- File

  JavaIoæµä¸­è¿˜æœ‰ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„ç±»ï¼šFileã€‚File æ˜¯â€œ**æ–‡ä»¶**â€å’Œâ€œ**ç›®å½•è·¯å¾„å**â€çš„æŠ½è±¡è¡¨ç¤ºå½¢å¼ã€‚

  

### åå°„

> åå°„å°±æ˜¯æŠŠJavaç±»ä¸­çš„å„ä¸ªæˆåˆ†æ˜ å°„æˆä¸€ä¸ªä¸ªçš„Javaå¯¹è±¡ã€‚å³åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€ä»¥å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½è°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ã€‚è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½å«Javaçš„åå°„æœºåˆ¶ã€‚

#### Javaåå°„æœºåˆ¶ä¸»è¦æä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

- åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ã€‚
- åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ã€‚
- åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚
- åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚
- ç”ŸæˆåŠ¨æ€ä»£ç†ã€‚

#### Javaä¸­ä¸»è¦ç”±ä»¥ä¸‹çš„ç±»æ¥å®ç°Javaåå°„æœºåˆ¶ï¼ˆè¿™äº›ç±»éƒ½ä½äºjava.lang.reflectåŒ…ä¸­ï¼‰ï¼š

- Classç±»ï¼šä»£è¡¨ä¸€ä¸ªç±»ã€‚ Fieldç±»ï¼šä»£è¡¨ç±»çš„æˆå‘˜å˜é‡ï¼ˆæˆå‘˜å˜é‡ä¹Ÿç§°ä¸ºç±»çš„å±æ€§ï¼‰ã€‚
- Methodç±»ï¼šä»£è¡¨ç±»çš„æ–¹æ³•ã€‚
- Constructorç±»ï¼šä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•ã€‚
- Arrayç±»ï¼šæä¾›äº†åŠ¨æ€åˆ›å»ºæ•°ç»„ï¼Œä»¥åŠè®¿é—®æ•°ç»„çš„å…ƒç´ çš„é™æ€æ–¹æ³•ã€‚